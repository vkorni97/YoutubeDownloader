!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=22)}([function(t,e){t.exports=require("url")},function(t,e,r){"use strict";r(10).exec;var n=r(21).platform().match(/win(32|64)/),i=r(41),o=/\r\n|\r|\n/g,a=/^\[?(.*?)\]?$/,s=/[,]/,u={};var c=t.exports={isWindows:n,streamRegexp:a,copy:function(t,e){Object.keys(t).forEach((function(r){e[r]=t[r]}))},args:function(){var t=[],e=function(){t=1===arguments.length&&Array.isArray(arguments[0])?t.concat(arguments[0]):t.concat([].slice.call(arguments))};return e.clear=function(){t=[]},e.get=function(){return t},e.find=function(e,r){var n=t.indexOf(e);if(-1!==n)return t.slice(n+1,n+1+(r||0))},e.remove=function(e,r){var n=t.indexOf(e);-1!==n&&t.splice(n,(r||0)+1)},e.clone=function(){var e=c.args();return e(t),e},e},makeFilterStrings:function(t){return t.map((function(t){if("string"==typeof t)return t;var e="";return Array.isArray(t.inputs)?e+=t.inputs.map((function(t){return t.replace(a,"[$1]")})).join(""):"string"==typeof t.inputs&&(e+=t.inputs.replace(a,"[$1]")),e+=t.filter,t.options&&("string"==typeof t.options||"number"==typeof t.options?e+="="+t.options:Array.isArray(t.options)?e+="="+t.options.map((function(t){return"string"==typeof t&&t.match(s)?"'"+t+"'":t})).join(":"):Object.keys(t.options).length&&(e+="="+Object.keys(t.options).map((function(e){var r=t.options[e];return"string"==typeof r&&r.match(s)&&(r="'"+r+"'"),e+"="+r})).join(":"))),Array.isArray(t.outputs)?e+=t.outputs.map((function(t){return t.replace(a,"[$1]")})).join(""):"string"==typeof t.outputs&&(e+=t.outputs.replace(a,"[$1]")),e}))},which:function(t,e){if(t in u)return e(null,u[t]);i(t,(function(r,n){if(r)return e(null,u[t]="");e(null,u[t]=n)}))},timemarkToSeconds:function(t){if("number"==typeof t)return t;if(-1===t.indexOf(":")&&t.indexOf(".")>=0)return Number(t);var e=t.split(":"),r=Number(e.pop());return e.length&&(r+=60*Number(e.pop())),e.length&&(r+=3600*Number(e.pop())),r},extractCodecData:function(t,e,r){"inputStack"in r||(r.inputStack=[],r.inputIndex=-1,r.inInput=!1);var n,i,o,a,s=r.inputStack,u=r.inputIndex,c=r.inInput;if(n=e.match(/Input #[0-9]+, ([^ ]+),/))c=r.inInput=!0,s[u=r.inputIndex=r.inputIndex+1]={format:n[1],audio:"",video:"",duration:""};else if(c&&(i=e.match(/Duration\: ([^,]+)/)))s[u].duration=i[1];else if(c&&(o=e.match(/Audio\: (.*)/)))o=o[1].split(", "),s[u].audio=o[0],s[u].audio_details=o;else if(c&&(a=e.match(/Video\: (.*)/)))a=a[1].split(", "),s[u].video=a[0],s[u].video_details=a;else if(/Output #\d+/.test(e))c=r.inInput=!1;else if(/Stream mapping:|Press (\[q\]|ctrl-c) to stop/.test(e))return t.emit.apply(t,["codecData"].concat(s)),!0;return!1},extractProgress:function(t,e){var r=function(t){for(var e={},r=(t=t.replace(/=\s+/g,"=").trim()).split(" "),n=0;n<r.length;n++){var i=r[n].split("=",2),o=i[0],a=i[1];if(void 0===a)return null;e[o]=a}return e}(e);if(r){var n={frames:parseInt(r.frame,10),currentFps:parseInt(r.fps,10),currentKbps:r.bitrate?parseFloat(r.bitrate.replace("kbits/s","")):0,targetSize:parseInt(r.size||r.Lsize,10),timemark:r.time};if(t._ffprobeData&&t._ffprobeData.format&&t._ffprobeData.format.duration){var i=Number(t._ffprobeData.format.duration);isNaN(i)||(n.percent=c.timemarkToSeconds(n.timemark)/i*100)}t.emit("progress",n)}},extractError:function(t){return t.split(o).reduce((function(t,e){return" "===e.charAt(0)||"["===e.charAt(0)?[]:(t.push(e),t)}),[]).join("\n")},linesRing:function(t){var e=[],r=[],n=null,i=!1,a=t-1;function s(t){e.forEach((function(e){e(t)}))}return{callback:function(t){r.forEach((function(e){t(e)})),e.push(t)},append:function(t){if(!i&&(t instanceof Buffer&&(t=""+t),t&&0!==t.length)){var e=t.split(o);1===e.length?null!==n?n+=e.shift():n=e.shift():(null!==n&&(s(n+=e.shift()),r.push(n)),n=e.pop(),e.forEach((function(t){s(t),r.push(t)})),a>-1&&r.length>a&&r.splice(0,r.length-a))}},get:function(){return null!==n?r.concat([n]).join("\n"):r.join("\n")},close:function(){i||(null!==n&&(s(n),r.push(n),a>-1&&r.length>a&&r.shift(),n=null),i=!0)}}}}},function(t,e){t.exports=require("path")},function(t,e){t.exports=require("fs")},function(t,e){t.exports=require("stream")},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function s(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};const o=i(r(26)),a=i(r(27)),s=r(0),u=r(4),c={"http:":o.default,"https:":a.default},l=new Set([301,302,303,307,308]),p=new Set([429,503]),f=["connect","continue","information","socket","timeout","upgrade"],d=["aborted"];function h(t,e={}){var r;const i=Object.assign({},h.defaultOptions,e),o=new u.PassThrough({highWaterMark:i.highWaterMark});let a,m,g;o.destroyed=o.aborted=!1;let y,b,v,w=0,_=0,E=0,T=!1,I=0,O=0;if(null===(r=i.headers)||void 0===r?void 0:r.Range){let t=/bytes=(\d+)-(\d+)?/.exec(i.headers.Range+"");t&&(I=parseInt(t[1],10),v=parseInt(t[2],10))}i.acceptEncoding&&(i.headers=Object.assign({"Accept-Encoding":Object.keys(i.acceptEncoding).join(", ")},i.headers));const A=t=>!!("HEAD"!=e.method&&T&&O!=b&&E++<i.maxReconnects)&&((t=>{g=null,_=0;let e=i.backoff.inc,r=Math.min(e,i.backoff.max);y=setTimeout(N,r),o.emit("reconnect",E,t)})(t),!0),x=t=>{if(o.destroyed)return!1;if(g&&0<O)return A(t.err);if((!t.statusCode||"ENOTFOUND"===t.err.message)&&_++<i.maxRetries){let e=t.retryAfter||Math.min(_*i.backoff.inc,i.backoff.max);return y=setTimeout(N,e),o.emit("retry",_,t.err),!0}return!1},S=(t,e)=>{for(let r of e)t.on(r,o.emit.bind(o,r))},N=()=>{let e,r;try{e=s.parse(t),r=c[e.protocol]}catch(t){}if(!r)return void o.emit("error",new h.MinigetError("Invalid URL: "+t));if(Object.assign(e,i),T&&O>0){let t=O+I,r=v||"";e.headers=Object.assign({},e.headers,{Range:`bytes=${t}-${r}`})}if(i.transform){try{e=i.transform(e)}catch(t){return void o.emit("error",t)}if((!e||e.protocol)&&(r=c[null==e?void 0:e.protocol],!r))return void o.emit("error",new h.MinigetError("Invalid URL object from `transform` function"))}const n=(t,e)=>{y(),x({err:t,statusCode:e})?a.removeListener("close",u):o.emit("error",t)},u=()=>{y(),x({})},y=()=>{a.removeListener("error",n),a.removeListener("close",u),null==m||m.removeListener("data",_),null==g||g.removeListener("end",E),null==g||g.removeListener("error",n),null==m||m.removeListener("error",n)},_=t=>{O+=t.length},E=()=>{y(),A()||o.end()};a=r.request(e,e=>{if(!o.destroyed){if(l.has(e.statusCode))return w++>=i.maxRedirects?o.emit("error",new h.MinigetError("Too many redirects")):(t=e.headers.location,setTimeout(N,e.headers["retry-after"]?1e3*parseInt(e.headers["retry-after"],10):0),o.emit("redirect",t)),y();if(p.has(e.statusCode)){if(!x({retryAfter:parseInt(e.headers["retry-after"],10)})){let t=new h.MinigetError("Status code: "+e.statusCode,e.statusCode);o.emit("error",t)}return y()}if(e.statusCode<200||400<=e.statusCode){let t=new h.MinigetError("Status code: "+e.statusCode,e.statusCode);return e.statusCode>=500?n(t,e.statusCode):o.emit("error",t),y()}if(g=e,i.acceptEncoding&&e.headers["content-encoding"])for(let t of e.headers["content-encoding"].split(", ").reverse()){let e=i.acceptEncoding[t];null!=e&&(g=g.pipe(e()),g.on("error",n))}b||(b=parseInt(e.headers["content-length"]+"",10),T="bytes"===e.headers["accept-ranges"]&&b>0&&i.maxReconnects>0),e.on("data",_),g.on("end",E),g.pipe(o,{end:!T}),m=e,o.emit("response",e),e.on("error",n),S(e,d)}}),a.on("error",n),a.on("close",u),S(a,f),o.destroyed&&R(D),o.emit("request",a),a.end()};let D;o.abort=t=>{console.warn("`MinigetStream#abort()` has been deprecated in favor of `MinigetStream#destroy()`"),o.aborted=!0,o.emit("abort"),o.destroy(t)};const R=t=>{a.destroy(t),null==g||g.unpipe(o),null==g||g.destroy(),clearTimeout(y)};return o._destroy=t=>{o.destroyed=!0,a?R(t):D=t},o.text=()=>n(this,void 0,void 0,(function*(){return new Promise((t,e)=>{let r="";o.setEncoding("utf8"),o.on("data",t=>r+=t),o.on("end",()=>t(r)),o.on("error",e)})})),process.nextTick(N),o}h.MinigetError=class extends Error{constructor(t,e){super(t),this.statusCode=e}},h.defaultOptions={maxRedirects:10,maxRetries:2,maxReconnects:0,backoff:{inc:100,max:1e4}},t.exports=h},function(t,e){t.exports=require("querystring")},function(t,e,r){const n=r(5);e.between=(t,e,r)=>{let n;if(e instanceof RegExp){const r=t.match(e);if(!r)return"";n=r.index+r[0].length}else{if(n=t.indexOf(e),-1===n)return"";n+=e.length}return n=(t=t.slice(n)).indexOf(r),-1===n?"":t=t.slice(0,n)},e.parseAbbreviatedNumber=t=>{const e=t.replace(",",".").replace(" ","").match(/([\d,.]+)([MK]?)/);if(e){let[,t,r]=e;return t=parseFloat(t),Math.round("M"===r?1e6*t:"K"===r?1e3*t:t)}return null},e.cutAfterJSON=t=>{let e,r;if("["===t[0]?(e="[",r="]"):"{"===t[0]&&(e="{",r="}"),!e)throw new Error("Can't cut unsupported JSON (need to begin with [ or { ) but got: "+t[0]);let n,i=!1,o=0;for(n=0;n<t.length;n++)if('"'!==t[n]||"\\"===t[n-1]){if(!i&&(t[n]===e?o++:t[n]===r&&o--,0===o))return t.substr(0,n+1)}else i=!i;throw Error("Can't cut unsupported JSON (no matching closing bracket found)")},e.playError=(t,e,r=Error)=>{let n=t&&t.playabilityStatus;return n&&e.includes(n.status)?new r(n.reason||n.messages&&n.messages[0]):null},e.deprecate=(t,e,r,n,i)=>{Object.defineProperty(t,e,{get:()=>(console.warn(`\`${n}\` will be removed in a near future release, use \`${i}\` instead.`),r)})};const i=r(28);e.lastUpdateCheck=0,e.checkForUpdates=()=>!process.env.YTDL_NO_UPDATE&&!i.version.startsWith("0.0.0-")&&Date.now()-e.lastUpdateCheck>=432e5?(e.lastUpdateCheck=Date.now(),n("https://api.github.com/repos/fent/node-ytdl-core/releases/latest",{headers:{"User-Agent":"ytdl-core"}}).text().then(t=>{JSON.parse(t).tag_name!=="v"+i.version&&console.warn('[33mWARNING:[0m ytdl-core is out of date! Update with "npm install ytdl-core@latest".')},t=>{console.warn("Error checking for updates:",t.message),console.warn("You can disable this check by setting the `YTDL_NO_UPDATE` env variable.")})):null},function(t,e,r){t.exports=r(38)},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};const i=r(4),o=r(0),a=n(r(5)),s=n(r(31)),u=n(r(32)),c=n(r(33)),l=r(16),p={m3u8:s.default,"dash-mpd":u.default};let f=(t,e={})=>{const r=new i.PassThrough,n=e.chunkReadahead||3,s=e.liveBuffer||2e4,u=e.requestOptions,f=p[e.parser||(/\.mpd$/.test(t)?"dash-mpd":"m3u8")];if(!f)throw TypeError(`parser '${e.parser}' not supported`);let d=0;void 0!==e.begin&&(d="string"==typeof e.begin?l.humanStr(e.begin):Math.max(e.begin-s,0));const h=t=>{for(let e of["abort","request","response","redirect","retry","reconnect"])t.on(e,r.emit.bind(r,e))};let m;const g=new c.default((t,e)=>{m=t;let n=0;t.on("data",t=>n+=t.length),t.pipe(r,{end:!1}),t.on("end",()=>e(void 0,n))},{concurrency:1});let y=0,b=0;const v=new c.default((e,n)=>{let i=Object.assign({},u);e.range&&(i.headers=Object.assign({},i.headers,{Range:`bytes=${e.range.start}-${e.range.end}`}));let s=a.default(o.resolve(t,e.url),i);s.on("error",n),h(s),g.push(s,(t,i)=>{b+=+i,r.emit("progress",{num:++y,size:i,duration:e.duration,url:e.url},v.total,b),n()})},{concurrency:n}),w=t=>{A||(r.emit("error",t),r.end())};let _,E,T,I,O=!0,A=!1,x=!1;const S=t=>{if(m=null,t)w(t);else if(!O&&!A&&!x&&v.tasks.length+v.active<=_){let t=Math.max(0,E-(Date.now()-I));O=!0,T=setTimeout(F,t)}else!A&&!x||v.tasks.length||v.active||r.end()};let N,D,R=0;const F=()=>{I=Date.now(),N=a.default(t,u),N.on("error",w),h(N);const r=N.pipe(new f(e.id));r.on("starttime",t=>{R||(R=t,"string"==typeof e.begin&&d>=0&&(d+=R))}),r.on("endlist",()=>{x=!0}),r.on("endearly",N.unpipe.bind(N,r));let n=[];const i=t=>{if(!t.init){if(t.seq<=D)return;D=t.seq}d=t.time,v.push(t,S),n.push(t)};let o=[],c=0;r.on("item",t=>{let e=Object.assign({time:R},t);if(d<=e.time)i(e);else for(o.push(e),c+=e.duration;o.length>1&&c-o[0].duration>s;)c-=o.shift().duration;R+=e.duration}),r.on("end",()=>{N=null,!n.length&&o.length&&o.forEach(t=>{i(t)}),_=Math.max(1,Math.ceil(.01*n.length)),E=n.reduce((t,e)=>e.duration+t,0),O=!1,S()})};return F(),r.end=()=>{A=!0,g.die(),v.die(),clearTimeout(T),null==N||N.destroy(),null==m||m.destroy(),i.PassThrough.prototype.end.call(r,null)},r};f.parseTimestamp=l.humanStr,t.exports=f},function(t,e){t.exports=require("child_process")},function(t,e,r){(function(t){(function(e){"use strict";function r(t,e){e|=0;for(var r=Math.max(t.length-e,0),n=Array(r),i=0;i<r;i++)n[i]=t[e+i];return n}var n=function(t){var e=r(arguments,1);return function(){var n=r(arguments);return t.apply(null,e.concat(n))}},i=function(t){return function(){var e=r(arguments),n=e.pop();t.call(this,e,n)}};function o(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var a="function"==typeof setImmediate&&setImmediate,s="object"==typeof process&&"function"==typeof process.nextTick;function u(t){setTimeout(t,0)}function c(t){return function(e){var n=r(arguments,1);t((function(){e.apply(null,n)}))}}var l=c(a?setImmediate:s?process.nextTick:u);function p(t){return i((function(e,r){var n;try{n=t.apply(this,e)}catch(t){return r(t)}o(n)&&"function"==typeof n.then?n.then((function(t){f(r,null,t)}),(function(t){f(r,t.message?t:new Error(t))})):r(null,n)}))}function f(t,e,r){try{t(e,r)}catch(t){l(d,t)}}function d(t){throw t}var h="function"==typeof Symbol;function m(t){return h&&"AsyncFunction"===t[Symbol.toStringTag]}function g(t){return m(t)?p(t):t}function y(t){return function(e){var n=r(arguments,1),o=i((function(r,n){var i=this;return t(e,(function(t,e){g(t).apply(i,r.concat(e))}),n)}));return n.length?o.apply(this,n):o}}var b="object"==typeof global&&global&&global.Object===Object&&global,v="object"==typeof self&&self&&self.Object===Object&&self,w=b||v||Function("return this")(),_=w.Symbol,E=Object.prototype,T=E.hasOwnProperty,I=E.toString,O=_?_.toStringTag:void 0,A=Object.prototype.toString,x=_?_.toStringTag:void 0;function S(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":x&&x in Object(t)?function(t){var e=T.call(t,O),r=t[O];try{t[O]=void 0;var n=!0}catch(t){}var i=I.call(t);return n&&(e?t[O]=r:delete t[O]),i}(t):function(t){return A.call(t)}(t)}function N(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function D(t){return null!=t&&N(t.length)&&!function(t){if(!o(t))return!1;var e=S(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}(t)}var R={};function F(){}function L(t){return function(){if(null!==t){var e=t;t=null,e.apply(this,arguments)}}}var P="function"==typeof Symbol&&Symbol.iterator;function k(t){return null!=t&&"object"==typeof t}function C(t){return k(t)&&"[object Arguments]"==S(t)}var j=Object.prototype,B=j.hasOwnProperty,q=j.propertyIsEnumerable,M=C(function(){return arguments}())?C:function(t){return k(t)&&B.call(t,"callee")&&!q.call(t,"callee")},V=Array.isArray,U="object"==typeof e&&e&&!e.nodeType&&e,$=U&&"object"==typeof t&&t&&!t.nodeType&&t,H=$&&$.exports===U?w.Buffer:void 0,z=(H?H.isBuffer:void 0)||function(){return!1},G=/^(?:0|[1-9]\d*)$/;function X(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&G.test(t))&&t>-1&&t%1==0&&t<e}var Y={};Y["[object Float32Array]"]=Y["[object Float64Array]"]=Y["[object Int8Array]"]=Y["[object Int16Array]"]=Y["[object Int32Array]"]=Y["[object Uint8Array]"]=Y["[object Uint8ClampedArray]"]=Y["[object Uint16Array]"]=Y["[object Uint32Array]"]=!0,Y["[object Arguments]"]=Y["[object Array]"]=Y["[object ArrayBuffer]"]=Y["[object Boolean]"]=Y["[object DataView]"]=Y["[object Date]"]=Y["[object Error]"]=Y["[object Function]"]=Y["[object Map]"]=Y["[object Number]"]=Y["[object Object]"]=Y["[object RegExp]"]=Y["[object Set]"]=Y["[object String]"]=Y["[object WeakMap]"]=!1;var W,Q="object"==typeof e&&e&&!e.nodeType&&e,J=Q&&"object"==typeof t&&t&&!t.nodeType&&t,K=J&&J.exports===Q&&b.process,Z=function(){try{var t=J&&J.require&&J.require("util").types;return t||K&&K.binding&&K.binding("util")}catch(t){}}(),tt=Z&&Z.isTypedArray,et=tt?(W=tt,function(t){return W(t)}):function(t){return k(t)&&N(t.length)&&!!Y[S(t)]},rt=Object.prototype.hasOwnProperty;function nt(t,e){var r=V(t),n=!r&&M(t),i=!r&&!n&&z(t),o=!r&&!n&&!i&&et(t),a=r||n||i||o,s=a?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],u=s.length;for(var c in t)!e&&!rt.call(t,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||X(c,u))||s.push(c);return s}var it=Object.prototype,ot=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),at=Object.prototype.hasOwnProperty;function st(t){if(r=(e=t)&&e.constructor,e!==("function"==typeof r&&r.prototype||it))return ot(t);var e,r,n=[];for(var i in Object(t))at.call(t,i)&&"constructor"!=i&&n.push(i);return n}function ut(t){return D(t)?nt(t):st(t)}function ct(t){if(D(t))return function(t){var e=-1,r=t.length;return function(){return++e<r?{value:t[e],key:e}:null}}(t);var e,r,n,i,o=function(t){return P&&t[P]&&t[P]()}(t);return o?function(t){var e=-1;return function(){var r=t.next();return r.done?null:(e++,{value:r.value,key:e})}}(o):(r=ut(e=t),n=-1,i=r.length,function(){var t=r[++n];return n<i?{value:e[t],key:t}:null})}function lt(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}function pt(t){return function(e,r,n){if(n=L(n||F),t<=0||!e)return n(null);var i=ct(e),o=!1,a=0,s=!1;function u(t,e){if(a-=1,t)o=!0,n(t);else{if(e===R||o&&a<=0)return o=!0,n(null);s||c()}}function c(){for(s=!0;a<t&&!o;){var e=i();if(null===e)return o=!0,void(a<=0&&n(null));a+=1,r(e.value,e.key,lt(u))}s=!1}c()}}function ft(t,e,r,n){pt(e)(t,g(r),n)}function dt(t,e){return function(r,n,i){return t(r,e,n,i)}}function ht(t,e,r){r=L(r||F);var n=0,i=0,o=t.length;function a(t,e){t?r(t):++i!==o&&e!==R||r(null)}for(0===o&&r(null);n<o;n++)e(t[n],n,lt(a))}var mt=dt(ft,1/0),gt=function(t,e,r){(D(t)?ht:mt)(t,g(e),r)};function yt(t){return function(e,r,n){return t(gt,e,g(r),n)}}function bt(t,e,r,n){n=n||F,e=e||[];var i=[],o=0,a=g(r);t(e,(function(t,e,r){var n=o++;a(t,(function(t,e){i[n]=e,r(t)}))}),(function(t){n(t,i)}))}var vt=yt(bt),wt=y(vt);function _t(t){return function(e,r,n,i){return t(pt(r),e,g(n),i)}}var Et=_t(bt),Tt=dt(Et,1),It=y(Tt);function Ot(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}var At,xt=function(t,e,r){for(var n=-1,i=Object(t),o=r(t),a=o.length;a--;){var s=o[At?a:++n];if(!1===e(i[s],s,i))break}return t};function St(t,e){return t&&xt(t,e,ut)}function Nt(t){return t!=t}function Dt(t,e,r){return e==e?function(t,e,r){for(var n=r-1,i=t.length;++n<i;)if(t[n]===e)return n;return-1}(t,e,r):function(t,e,r,n){for(var i=t.length,o=r+(n?1:-1);n?o--:++o<i;)if(e(t[o],o,t))return o;return-1}(t,Nt,r)}var Rt=function(t,e,n){"function"==typeof e&&(n=e,e=null),n=L(n||F);var i=ut(t).length;if(!i)return n(null);e||(e=i);var o={},a=0,s=!1,u=Object.create(null),c=[],l=[],p={};function f(t,e){c.push((function(){!function(t,e){if(!s){var i=lt((function(e,i){if(a--,arguments.length>2&&(i=r(arguments,1)),e){var c={};St(o,(function(t,e){c[e]=t})),c[t]=i,s=!0,u=Object.create(null),n(e,c)}else o[t]=i,h(t)}));a++;var c=g(e[e.length-1]);e.length>1?c(o,i):c(i)}}(t,e)}))}function d(){if(0===c.length&&0===a)return n(null,o);for(;c.length&&a<e;)c.shift()()}function h(t){Ot(u[t]||[],(function(t){t()})),d()}function m(e){var r=[];return St(t,(function(t,n){V(t)&&Dt(t,e,0)>=0&&r.push(n)})),r}St(t,(function(e,r){if(!V(e))return f(r,[e]),void l.push(r);var n=e.slice(0,e.length-1),i=n.length;if(0===i)return f(r,e),void l.push(r);p[r]=i,Ot(n,(function(o){if(!t[o])throw new Error("async.auto task `"+r+"` has a non-existent dependency `"+o+"` in "+n.join(", "));var a,s,c;s=function(){0==--i&&f(r,e)},(c=u[a=o])||(c=u[a]=[]),c.push(s)}))})),function(){for(var t,e=0;l.length;)t=l.pop(),e++,Ot(m(t),(function(t){0==--p[t]&&l.push(t)}));if(e!==i)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}(),d()};function Ft(t,e){for(var r=-1,n=null==t?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var Lt=_?_.prototype:void 0,Pt=Lt?Lt.toString:void 0;function kt(t){if("string"==typeof t)return t;if(V(t))return Ft(t,kt)+"";if(function(t){return"symbol"==typeof t||k(t)&&"[object Symbol]"==S(t)}(t))return Pt?Pt.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Ct(t,e,r){var n=t.length;return r=void 0===r?n:r,!e&&r>=n?t:function(t,e,r){var n=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(r=r>i?i:r)<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var o=Array(i);++n<i;)o[n]=t[n+e];return o}(t,e,r)}var jt=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),Bt="[\\ud800-\\udfff]",qt="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Mt="\\ud83c[\\udffb-\\udfff]",Vt="[^\\ud800-\\udfff]",Ut="(?:\\ud83c[\\udde6-\\uddff]){2}",$t="[\\ud800-\\udbff][\\udc00-\\udfff]",Ht="(?:"+qt+"|"+Mt+")?",zt="[\\ufe0e\\ufe0f]?"+Ht+"(?:\\u200d(?:"+[Vt,Ut,$t].join("|")+")[\\ufe0e\\ufe0f]?"+Ht+")*",Gt="(?:"+[Vt+qt+"?",qt,Ut,$t,Bt].join("|")+")",Xt=RegExp(Mt+"(?="+Mt+")|"+Gt+zt,"g");function Yt(t){return function(t){return jt.test(t)}(t)?function(t){return t.match(Xt)||[]}(t):function(t){return t.split("")}(t)}var Wt=/^\s+|\s+$/g;function Qt(t,e,r){var n;if((t=null==(n=t)?"":kt(n))&&(r||void 0===e))return t.replace(Wt,"");if(!t||!(e=kt(e)))return t;var i=Yt(t),o=Yt(e);return Ct(i,function(t,e){for(var r=-1,n=t.length;++r<n&&Dt(e,t[r],0)>-1;);return r}(i,o),function(t,e){for(var r=t.length;r--&&Dt(e,t[r],0)>-1;);return r}(i,o)+1).join("")}var Jt=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,Kt=/,/,Zt=/(=.+)?(\s*)$/,te=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;function ee(t,e){var r={};St(t,(function(t,e){var n,i=m(t),o=!i&&1===t.length||i&&0===t.length;if(V(t))n=t.slice(0,-1),t=t[t.length-1],r[e]=n.concat(n.length>0?a:t);else if(o)r[e]=t;else{if(n=function(t){return t=(t=(t=(t=t.toString().replace(te,"")).match(Jt)[2].replace(" ",""))?t.split(Kt):[]).map((function(t){return Qt(t.replace(Zt,""))}))}(t),0===t.length&&!i&&0===n.length)throw new Error("autoInject task functions require explicit parameters.");i||n.pop(),r[e]=n.concat(a)}function a(e,r){var i=Ft(n,(function(t){return e[t]}));i.push(r),g(t).apply(null,i)}})),Rt(r,e)}function re(){this.head=this.tail=null,this.length=0}function ne(t,e){t.length=1,t.head=t.tail=e}function ie(t,e,r){if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var n=g(t),i=0,o=[],a=!1;function s(t,e,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(p.started=!0,V(t)||(t=[t]),0===t.length&&p.idle())return l((function(){p.drain()}));for(var n=0,i=t.length;n<i;n++){var o={data:t[n],callback:r||F};e?p._tasks.unshift(o):p._tasks.push(o)}a||(a=!0,l((function(){a=!1,p.process()})))}function u(t){return function(e){i-=1;for(var r=0,n=t.length;r<n;r++){var a=t[r],s=Dt(o,a,0);0===s?o.shift():s>0&&o.splice(s,1),a.callback.apply(a,arguments),null!=e&&p.error(e,a.data)}i<=p.concurrency-p.buffer&&p.unsaturated(),p.idle()&&p.drain(),p.process()}}var c=!1,p={_tasks:new re,concurrency:e,payload:r,saturated:F,unsaturated:F,buffer:e/4,empty:F,drain:F,error:F,started:!1,paused:!1,push:function(t,e){s(t,!1,e)},kill:function(){p.drain=F,p._tasks.empty()},unshift:function(t,e){s(t,!0,e)},remove:function(t){p._tasks.remove(t)},process:function(){if(!c){for(c=!0;!p.paused&&i<p.concurrency&&p._tasks.length;){var t=[],e=[],r=p._tasks.length;p.payload&&(r=Math.min(r,p.payload));for(var a=0;a<r;a++){var s=p._tasks.shift();t.push(s),o.push(s),e.push(s.data)}i+=1,0===p._tasks.length&&p.empty(),i===p.concurrency&&p.saturated();var l=lt(u(t));n(e,l)}c=!1}},length:function(){return p._tasks.length},running:function(){return i},workersList:function(){return o},idle:function(){return p._tasks.length+i===0},pause:function(){p.paused=!0},resume:function(){!1!==p.paused&&(p.paused=!1,l(p.process))}};return p}function oe(t,e){return ie(t,1,e)}re.prototype.removeLink=function(t){return t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev,t.prev=t.next=null,this.length-=1,t},re.prototype.empty=function(){for(;this.head;)this.shift();return this},re.prototype.insertAfter=function(t,e){e.prev=t,e.next=t.next,t.next?t.next.prev=e:this.tail=e,t.next=e,this.length+=1},re.prototype.insertBefore=function(t,e){e.prev=t.prev,e.next=t,t.prev?t.prev.next=e:this.head=e,t.prev=e,this.length+=1},re.prototype.unshift=function(t){this.head?this.insertBefore(this.head,t):ne(this,t)},re.prototype.push=function(t){this.tail?this.insertAfter(this.tail,t):ne(this,t)},re.prototype.shift=function(){return this.head&&this.removeLink(this.head)},re.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},re.prototype.toArray=function(){for(var t=Array(this.length),e=this.head,r=0;r<this.length;r++)t[r]=e.data,e=e.next;return t},re.prototype.remove=function(t){for(var e=this.head;e;){var r=e.next;t(e)&&this.removeLink(e),e=r}return this};var ae=dt(ft,1);function se(t,e,r,n){n=L(n||F);var i=g(r);ae(t,(function(t,r,n){i(e,t,(function(t,r){e=r,n(t)}))}),(function(t){n(t,e)}))}function ue(){var t=Ft(arguments,g);return function(){var e=r(arguments),n=this,i=e[e.length-1];"function"==typeof i?e.pop():i=F,se(t,e,(function(t,e,i){e.apply(n,t.concat((function(t){var e=r(arguments,1);i(t,e)})))}),(function(t,e){i.apply(n,[t].concat(e))}))}}var ce=function(){return ue.apply(null,r(arguments).reverse())},le=Array.prototype.concat,pe=function(t,e,n,i){i=i||F;var o=g(n);Et(t,e,(function(t,e){o(t,(function(t){return t?e(t):e(null,r(arguments,1))}))}),(function(t,e){for(var r=[],n=0;n<e.length;n++)e[n]&&(r=le.apply(r,e[n]));return i(t,r)}))},fe=dt(pe,1/0),de=dt(pe,1),he=function(){var t=r(arguments),e=[null].concat(t);return function(){var t=arguments[arguments.length-1];return t.apply(this,e)}};function me(t){return t}function ge(t,e){return function(r,n,i,o){o=o||F;var a,s=!1;r(n,(function(r,n,o){i(r,(function(n,i){n?o(n):t(i)&&!a?(s=!0,a=e(!0,r),o(null,R)):o()}))}),(function(t){t?o(t):o(null,s?a:e(!1))}))}}function ye(t,e){return e}var be=yt(ge(me,ye)),ve=_t(ge(me,ye)),we=dt(ve,1);function _e(t){return function(e){var n=r(arguments,1);n.push((function(e){var n=r(arguments,1);"object"==typeof console&&(e?console.error&&console.error(e):console[t]&&Ot(n,(function(e){console[t](e)})))})),g(e).apply(null,n)}}var Ee=_e("dir");function Te(t,e,n){n=lt(n||F);var i=g(t),o=g(e);function a(t){if(t)return n(t);var e=r(arguments,1);e.push(s),o.apply(this,e)}function s(t,e){return t?n(t):e?void i(a):n(null)}s(null,!0)}function Ie(t,e,n){n=lt(n||F);var i=g(t),o=function(t){if(t)return n(t);var a=r(arguments,1);if(e.apply(this,a))return i(o);n.apply(null,[null].concat(a))};i(o)}function Oe(t,e,r){Ie(t,(function(){return!e.apply(this,arguments)}),r)}function Ae(t,e,r){r=lt(r||F);var n=g(e),i=g(t);function o(t){if(t)return r(t);i(a)}function a(t,e){return t?r(t):e?void n(o):r(null)}i(a)}function xe(t){return function(e,r,n){return t(e,n)}}function Se(t,e,r){gt(t,xe(g(e)),r)}function Ne(t,e,r,n){pt(e)(t,xe(g(r)),n)}var De=dt(Ne,1);function Re(t){return m(t)?t:i((function(e,r){var n=!0;e.push((function(){var t=arguments;n?l((function(){r.apply(null,t)})):r.apply(null,t)})),t.apply(this,e),n=!1}))}function Fe(t){return!t}var Le=yt(ge(Fe,Fe)),Pe=_t(ge(Fe,Fe)),ke=dt(Pe,1);function Ce(t){return function(e){return null==e?void 0:e[t]}}function je(t,e,r,n){var i=new Array(e.length);t(e,(function(t,e,n){r(t,(function(t,r){i[e]=!!r,n(t)}))}),(function(t){if(t)return n(t);for(var r=[],o=0;o<e.length;o++)i[o]&&r.push(e[o]);n(null,r)}))}function Be(t,e,r,n){var i=[];t(e,(function(t,e,n){r(t,(function(r,o){r?n(r):(o&&i.push({index:e,value:t}),n())}))}),(function(t){t?n(t):n(null,Ft(i.sort((function(t,e){return t.index-e.index})),Ce("value")))}))}function qe(t,e,r,n){(D(e)?je:Be)(t,e,g(r),n||F)}var Me=yt(qe),Ve=_t(qe),Ue=dt(Ve,1);function $e(t,e){var r=lt(e||F),n=g(Re(t));!function t(e){if(e)return r(e);n(t)}()}var He=function(t,e,r,n){n=n||F;var i=g(r);Et(t,e,(function(t,e){i(t,(function(r,n){return r?e(r):e(null,{key:n,val:t})}))}),(function(t,e){for(var r={},i=Object.prototype.hasOwnProperty,o=0;o<e.length;o++)if(e[o]){var a=e[o].key,s=e[o].val;i.call(r,a)?r[a].push(s):r[a]=[s]}return n(t,r)}))},ze=dt(He,1/0),Ge=dt(He,1),Xe=_e("log");function Ye(t,e,r,n){n=L(n||F);var i={},o=g(r);ft(t,e,(function(t,e,r){o(t,e,(function(t,n){if(t)return r(t);i[e]=n,r()}))}),(function(t){n(t,i)}))}var We=dt(Ye,1/0),Qe=dt(Ye,1);function Je(t,e){return e in t}function Ke(t,e){var n=Object.create(null),o=Object.create(null);e=e||me;var a=g(t),s=i((function(t,i){var s=e.apply(null,t);Je(n,s)?l((function(){i.apply(null,n[s])})):Je(o,s)?o[s].push(i):(o[s]=[i],a.apply(null,t.concat((function(){var t=r(arguments);n[s]=t;var e=o[s];delete o[s];for(var i=0,a=e.length;i<a;i++)e[i].apply(null,t)}))))}));return s.memo=n,s.unmemoized=t,s}var Ze=c(s?process.nextTick:a?setImmediate:u);function tr(t,e,n){n=n||F;var i=D(e)?[]:{};t(e,(function(t,e,n){g(t)((function(t,o){arguments.length>2&&(o=r(arguments,1)),i[e]=o,n(t)}))}),(function(t){n(t,i)}))}function er(t,e){tr(gt,t,e)}function rr(t,e,r){tr(pt(e),t,r)}var nr=function(t,e){var r=g(t);return ie((function(t,e){r(t[0],e)}),e,1)},ir=function(t,e){var r=nr(t,e);return r.push=function(t,e,n){if(null==n&&(n=F),"function"!=typeof n)throw new Error("task callback must be a function");if(r.started=!0,V(t)||(t=[t]),0===t.length)return l((function(){r.drain()}));e=e||0;for(var i=r._tasks.head;i&&e>=i.priority;)i=i.next;for(var o=0,a=t.length;o<a;o++){var s={data:t[o],priority:e,callback:n};i?r._tasks.insertBefore(i,s):r._tasks.push(s)}l(r.process)},delete r.unshift,r};function or(t,e){if(e=L(e||F),!V(t))return e(new TypeError("First argument to race must be an array of functions"));if(!t.length)return e();for(var r=0,n=t.length;r<n;r++)g(t[r])(e)}function ar(t,e,n,i){se(r(t).reverse(),e,n,i)}function sr(t){var e=g(t);return i((function(t,n){return t.push((function(t,e){var i;t?n(null,{error:t}):(i=arguments.length<=2?e:r(arguments,1),n(null,{value:i}))})),e.apply(this,t)}))}function ur(t){var e;return V(t)?e=Ft(t,sr):(e={},St(t,(function(t,r){e[r]=sr.call(this,t)}))),e}function cr(t,e,r,n){qe(t,e,(function(t,e){r(t,(function(t,r){e(t,!r)}))}),n)}var lr=yt(cr),pr=_t(cr),fr=dt(pr,1);function dr(t){return function(){return t}}function hr(t,e,r){var n=5,i=0,o={times:n,intervalFunc:dr(i)};function a(t,e){if("object"==typeof e)t.times=+e.times||n,t.intervalFunc="function"==typeof e.interval?e.interval:dr(+e.interval||i),t.errorFilter=e.errorFilter;else{if("number"!=typeof e&&"string"!=typeof e)throw new Error("Invalid arguments for async.retry");t.times=+e||n}}if(arguments.length<3&&"function"==typeof t?(r=e||F,e=t):(a(o,t),r=r||F),"function"!=typeof e)throw new Error("Invalid arguments for async.retry");var s=g(e),u=1;function c(){s((function(t){t&&u++<o.times&&("function"!=typeof o.errorFilter||o.errorFilter(t))?setTimeout(c,o.intervalFunc(u)):r.apply(null,arguments)}))}c()}var mr=function(t,e){e||(e=t,t=null);var r=g(e);return i((function(e,n){function i(t){r.apply(null,e.concat(t))}t?hr(t,i,n):hr(i,n)}))};function gr(t,e){tr(ae,t,e)}var yr=yt(ge(Boolean,me)),br=_t(ge(Boolean,me)),vr=dt(br,1);function wr(t,e,r){var n=g(e);function i(t,e){var r=t.criteria,n=e.criteria;return r<n?-1:r>n?1:0}vt(t,(function(t,e){n(t,(function(r,n){if(r)return e(r);e(null,{value:t,criteria:n})}))}),(function(t,e){if(t)return r(t);r(null,Ft(e.sort(i),Ce("value")))}))}function _r(t,e,r){var n=g(t);return i((function(i,o){var a,s=!1;i.push((function(){s||(o.apply(null,arguments),clearTimeout(a))})),a=setTimeout((function(){var e=t.name||"anonymous",n=new Error('Callback function "'+e+'" timed out.');n.code="ETIMEDOUT",r&&(n.info=r),s=!0,o(n)}),e),n.apply(null,i)}))}var Er=Math.ceil,Tr=Math.max;function Ir(t,e,r,n){var i=g(r);Et(function(t,e,r,n){for(var i=-1,o=Tr(Er((e-t)/(r||1)),0),a=Array(o);o--;)a[n?o:++i]=t,t+=r;return a}(0,t,1),e,i,n)}var Or=dt(Ir,1/0),Ar=dt(Ir,1);function xr(t,e,r,n){arguments.length<=3&&(n=r,r=e,e=V(t)?[]:{}),n=L(n||F);var i=g(r);gt(t,(function(t,r,n){i(e,t,r,n)}),(function(t){n(t,e)}))}function Sr(t,e){var n,i=null;e=e||F,De(t,(function(t,e){g(t)((function(t,o){n=arguments.length>2?r(arguments,1):o,i=t,e(!t)}))}),(function(){e(i,n)}))}function Nr(t){return function(){return(t.unmemoized||t).apply(null,arguments)}}function Dr(t,e,n){n=lt(n||F);var i=g(e);if(!t())return n(null);var o=function(e){if(e)return n(e);if(t())return i(o);var a=r(arguments,1);n.apply(null,[null].concat(a))};i(o)}function Rr(t,e,r){Dr((function(){return!t.apply(this,arguments)}),e,r)}var Fr=function(t,e){if(e=L(e||F),!V(t))return e(new Error("First argument to waterfall must be an array of functions"));if(!t.length)return e();var n=0;function i(e){var r=g(t[n++]);e.push(lt(o)),r.apply(null,e)}function o(o){if(o||n===t.length)return e.apply(null,arguments);i(r(arguments,1))}i([])},Lr={apply:n,applyEach:wt,applyEachSeries:It,asyncify:p,auto:Rt,autoInject:ee,cargo:oe,compose:ce,concat:fe,concatLimit:pe,concatSeries:de,constant:he,detect:be,detectLimit:ve,detectSeries:we,dir:Ee,doDuring:Te,doUntil:Oe,doWhilst:Ie,during:Ae,each:Se,eachLimit:Ne,eachOf:gt,eachOfLimit:ft,eachOfSeries:ae,eachSeries:De,ensureAsync:Re,every:Le,everyLimit:Pe,everySeries:ke,filter:Me,filterLimit:Ve,filterSeries:Ue,forever:$e,groupBy:ze,groupByLimit:He,groupBySeries:Ge,log:Xe,map:vt,mapLimit:Et,mapSeries:Tt,mapValues:We,mapValuesLimit:Ye,mapValuesSeries:Qe,memoize:Ke,nextTick:Ze,parallel:er,parallelLimit:rr,priorityQueue:ir,queue:nr,race:or,reduce:se,reduceRight:ar,reflect:sr,reflectAll:ur,reject:lr,rejectLimit:pr,rejectSeries:fr,retry:hr,retryable:mr,seq:ue,series:gr,setImmediate:l,some:yr,someLimit:br,someSeries:vr,sortBy:wr,timeout:_r,times:Or,timesLimit:Ir,timesSeries:Ar,transform:xr,tryEach:Sr,unmemoize:Nr,until:Rr,waterfall:Fr,whilst:Dr,all:Le,allLimit:Pe,allSeries:ke,any:yr,anyLimit:br,anySeries:vr,find:be,findLimit:ve,findSeries:we,forEach:Se,forEachSeries:De,forEachLimit:Ne,forEachOf:gt,forEachOfSeries:ae,forEachOfLimit:ft,inject:se,foldl:se,foldr:ar,select:Me,selectLimit:Ve,selectSeries:Ue,wrapSync:p};e.default=Lr,e.apply=n,e.applyEach=wt,e.applyEachSeries=It,e.asyncify=p,e.auto=Rt,e.autoInject=ee,e.cargo=oe,e.compose=ce,e.concat=fe,e.concatLimit=pe,e.concatSeries=de,e.constant=he,e.detect=be,e.detectLimit=ve,e.detectSeries=we,e.dir=Ee,e.doDuring=Te,e.doUntil=Oe,e.doWhilst=Ie,e.during=Ae,e.each=Se,e.eachLimit=Ne,e.eachOf=gt,e.eachOfLimit=ft,e.eachOfSeries=ae,e.eachSeries=De,e.ensureAsync=Re,e.every=Le,e.everyLimit=Pe,e.everySeries=ke,e.filter=Me,e.filterLimit=Ve,e.filterSeries=Ue,e.forever=$e,e.groupBy=ze,e.groupByLimit=He,e.groupBySeries=Ge,e.log=Xe,e.map=vt,e.mapLimit=Et,e.mapSeries=Tt,e.mapValues=We,e.mapValuesLimit=Ye,e.mapValuesSeries=Qe,e.memoize=Ke,e.nextTick=Ze,e.parallel=er,e.parallelLimit=rr,e.priorityQueue=ir,e.queue=nr,e.race=or,e.reduce=se,e.reduceRight=ar,e.reflect=sr,e.reflectAll=ur,e.reject=lr,e.rejectLimit=pr,e.rejectSeries=fr,e.retry=hr,e.retryable=mr,e.seq=ue,e.series=gr,e.setImmediate=l,e.some=yr,e.someLimit=br,e.someSeries=vr,e.sortBy=wr,e.timeout=_r,e.times=Or,e.timesLimit=Ir,e.timesSeries=Ar,e.transform=xr,e.tryEach=Sr,e.unmemoize=Nr,e.until=Rr,e.waterfall=Fr,e.whilst=Dr,e.all=Le,e.allLimit=Pe,e.allSeries=ke,e.any=yr,e.anyLimit=br,e.anySeries=vr,e.find=be,e.findLimit=ve,e.findSeries=we,e.forEach=Se,e.forEachSeries=De,e.forEachLimit=Ne,e.forEachOf=gt,e.forEachOfSeries=ae,e.forEachOfLimit=ft,e.inject=se,e.foldl=se,e.foldr=ar,e.select=Me,e.selectLimit=Ve,e.selectSeries=Ue,e.wrapSync=p,Object.defineProperty(e,"__esModule",{value:!0})})(e)}).call(this,r(54)(t))},function(t,e,r){!function(t){t.parser=function(t,e){return new i(t,e)},t.SAXParser=i,t.SAXStream=a,t.createStream=function(t,e){return new a(t,e)},t.MAX_BUFFER_LENGTH=65536;var e,n=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function i(e,r){if(!(this instanceof i))return new i(e,r);!function(t){for(var e=0,r=n.length;e<r;e++)t[n[e]]=""}(this),this.q=this.c="",this.bufferCheckPosition=t.MAX_BUFFER_LENGTH,this.opt=r||{},this.opt.lowercase=this.opt.lowercase||this.opt.lowercasetags,this.looseCase=this.opt.lowercase?"toLowerCase":"toUpperCase",this.tags=[],this.closed=this.closedRoot=this.sawRoot=!1,this.tag=this.error=null,this.strict=!!e,this.noscript=!(!e&&!this.opt.noscript),this.state=_.BEGIN,this.strictEntities=this.opt.strictEntities,this.ENTITIES=this.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),this.attribList=[],this.opt.xmlns&&(this.ns=Object.create(u)),this.trackPosition=!1!==this.opt.position,this.trackPosition&&(this.position=this.line=this.column=0),T(this,"onready")}t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(t){function e(){}return e.prototype=t,new e}),Object.keys||(Object.keys=function(t){var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(r);return e}),i.prototype={end:function(){S(this)},write:function(e){if(this.error)throw this.error;if(this.closed)return x(this,"Cannot write after close. Assign an onready handler.");if(null===e)return S(this);"object"==typeof e&&(e=e.toString());var r=0,i="";for(;i=j(e,r++),this.c=i,i;)switch(this.trackPosition&&(this.position++,"\n"===i?(this.line++,this.column=0):this.column++),this.state){case _.BEGIN:if(this.state=_.BEGIN_WHITESPACE,"\ufeff"===i)continue;C(this,i);continue;case _.BEGIN_WHITESPACE:C(this,i);continue;case _.TEXT:if(this.sawRoot&&!this.closedRoot){for(var o=r-1;i&&"<"!==i&&"&"!==i;)(i=j(e,r++))&&this.trackPosition&&(this.position++,"\n"===i?(this.line++,this.column=0):this.column++);this.textNode+=e.substring(o,r-1)}"<"!==i||this.sawRoot&&this.closedRoot&&!this.strict?(d(i)||this.sawRoot&&!this.closedRoot||N(this,"Text data outside of root node."),"&"===i?this.state=_.TEXT_ENTITY:this.textNode+=i):(this.state=_.OPEN_WAKA,this.startTagPosition=this.position);continue;case _.SCRIPT:"<"===i?this.state=_.SCRIPT_ENDING:this.script+=i;continue;case _.SCRIPT_ENDING:"/"===i?this.state=_.CLOSE_TAG:(this.script+="<"+i,this.state=_.SCRIPT);continue;case _.OPEN_WAKA:if("!"===i)this.state=_.SGML_DECL,this.sgmlDecl="";else if(d(i));else if(g(c,i))this.state=_.OPEN_TAG,this.tagName=i;else if("/"===i)this.state=_.CLOSE_TAG,this.tagName="";else if("?"===i)this.state=_.PROC_INST,this.procInstName=this.procInstBody="";else{if(N(this,"Unencoded <"),this.startTagPosition+1<this.position){var a=this.position-this.startTagPosition;i=new Array(a).join(" ")+i}this.textNode+="<"+i,this.state=_.TEXT}continue;case _.SGML_DECL:"[CDATA["===(this.sgmlDecl+i).toUpperCase()?(I(this,"onopencdata"),this.state=_.CDATA,this.sgmlDecl="",this.cdata=""):this.sgmlDecl+i==="--"?(this.state=_.COMMENT,this.comment="",this.sgmlDecl=""):"DOCTYPE"===(this.sgmlDecl+i).toUpperCase()?(this.state=_.DOCTYPE,(this.doctype||this.sawRoot)&&N(this,"Inappropriately located doctype declaration"),this.doctype="",this.sgmlDecl=""):">"===i?(I(this,"onsgmldeclaration",this.sgmlDecl),this.sgmlDecl="",this.state=_.TEXT):h(i)?(this.state=_.SGML_DECL_QUOTED,this.sgmlDecl+=i):this.sgmlDecl+=i;continue;case _.SGML_DECL_QUOTED:i===this.q&&(this.state=_.SGML_DECL,this.q=""),this.sgmlDecl+=i;continue;case _.DOCTYPE:">"===i?(this.state=_.TEXT,I(this,"ondoctype",this.doctype),this.doctype=!0):(this.doctype+=i,"["===i?this.state=_.DOCTYPE_DTD:h(i)&&(this.state=_.DOCTYPE_QUOTED,this.q=i));continue;case _.DOCTYPE_QUOTED:this.doctype+=i,i===this.q&&(this.q="",this.state=_.DOCTYPE);continue;case _.DOCTYPE_DTD:this.doctype+=i,"]"===i?this.state=_.DOCTYPE:h(i)&&(this.state=_.DOCTYPE_DTD_QUOTED,this.q=i);continue;case _.DOCTYPE_DTD_QUOTED:this.doctype+=i,i===this.q&&(this.state=_.DOCTYPE_DTD,this.q="");continue;case _.COMMENT:"-"===i?this.state=_.COMMENT_ENDING:this.comment+=i;continue;case _.COMMENT_ENDING:"-"===i?(this.state=_.COMMENT_ENDED,this.comment=A(this.opt,this.comment),this.comment&&I(this,"oncomment",this.comment),this.comment=""):(this.comment+="-"+i,this.state=_.COMMENT);continue;case _.COMMENT_ENDED:">"!==i?(N(this,"Malformed comment"),this.comment+="--"+i,this.state=_.COMMENT):this.state=_.TEXT;continue;case _.CDATA:"]"===i?this.state=_.CDATA_ENDING:this.cdata+=i;continue;case _.CDATA_ENDING:"]"===i?this.state=_.CDATA_ENDING_2:(this.cdata+="]"+i,this.state=_.CDATA);continue;case _.CDATA_ENDING_2:">"===i?(this.cdata&&I(this,"oncdata",this.cdata),I(this,"onclosecdata"),this.cdata="",this.state=_.TEXT):"]"===i?this.cdata+="]":(this.cdata+="]]"+i,this.state=_.CDATA);continue;case _.PROC_INST:"?"===i?this.state=_.PROC_INST_ENDING:d(i)?this.state=_.PROC_INST_BODY:this.procInstName+=i;continue;case _.PROC_INST_BODY:if(!this.procInstBody&&d(i))continue;"?"===i?this.state=_.PROC_INST_ENDING:this.procInstBody+=i;continue;case _.PROC_INST_ENDING:">"===i?(I(this,"onprocessinginstruction",{name:this.procInstName,body:this.procInstBody}),this.procInstName=this.procInstBody="",this.state=_.TEXT):(this.procInstBody+="?"+i,this.state=_.PROC_INST_BODY);continue;case _.OPEN_TAG:g(l,i)?this.tagName+=i:(D(this),">"===i?L(this):"/"===i?this.state=_.OPEN_TAG_SLASH:(d(i)||N(this,"Invalid character in tag name"),this.state=_.ATTRIB));continue;case _.OPEN_TAG_SLASH:">"===i?(L(this,!0),P(this)):(N(this,"Forward-slash in opening tag not followed by >"),this.state=_.ATTRIB);continue;case _.ATTRIB:if(d(i))continue;">"===i?L(this):"/"===i?this.state=_.OPEN_TAG_SLASH:g(c,i)?(this.attribName=i,this.attribValue="",this.state=_.ATTRIB_NAME):N(this,"Invalid attribute name");continue;case _.ATTRIB_NAME:"="===i?this.state=_.ATTRIB_VALUE:">"===i?(N(this,"Attribute without value"),this.attribValue=this.attribName,F(this),L(this)):d(i)?this.state=_.ATTRIB_NAME_SAW_WHITE:g(l,i)?this.attribName+=i:N(this,"Invalid attribute name");continue;case _.ATTRIB_NAME_SAW_WHITE:if("="===i)this.state=_.ATTRIB_VALUE;else{if(d(i))continue;N(this,"Attribute without value"),this.tag.attributes[this.attribName]="",this.attribValue="",I(this,"onattribute",{name:this.attribName,value:""}),this.attribName="",">"===i?L(this):g(c,i)?(this.attribName=i,this.state=_.ATTRIB_NAME):(N(this,"Invalid attribute name"),this.state=_.ATTRIB)}continue;case _.ATTRIB_VALUE:if(d(i))continue;h(i)?(this.q=i,this.state=_.ATTRIB_VALUE_QUOTED):(N(this,"Unquoted attribute value"),this.state=_.ATTRIB_VALUE_UNQUOTED,this.attribValue=i);continue;case _.ATTRIB_VALUE_QUOTED:if(i!==this.q){"&"===i?this.state=_.ATTRIB_VALUE_ENTITY_Q:this.attribValue+=i;continue}F(this),this.q="",this.state=_.ATTRIB_VALUE_CLOSED;continue;case _.ATTRIB_VALUE_CLOSED:d(i)?this.state=_.ATTRIB:">"===i?L(this):"/"===i?this.state=_.OPEN_TAG_SLASH:g(c,i)?(N(this,"No whitespace between attributes"),this.attribName=i,this.attribValue="",this.state=_.ATTRIB_NAME):N(this,"Invalid attribute name");continue;case _.ATTRIB_VALUE_UNQUOTED:if(!m(i)){"&"===i?this.state=_.ATTRIB_VALUE_ENTITY_U:this.attribValue+=i;continue}F(this),">"===i?L(this):this.state=_.ATTRIB;continue;case _.CLOSE_TAG:if(this.tagName)">"===i?P(this):g(l,i)?this.tagName+=i:this.script?(this.script+="</"+this.tagName,this.tagName="",this.state=_.SCRIPT):(d(i)||N(this,"Invalid tagname in closing tag"),this.state=_.CLOSE_TAG_SAW_WHITE);else{if(d(i))continue;y(c,i)?this.script?(this.script+="</"+i,this.state=_.SCRIPT):N(this,"Invalid tagname in closing tag."):this.tagName=i}continue;case _.CLOSE_TAG_SAW_WHITE:if(d(i))continue;">"===i?P(this):N(this,"Invalid characters in closing tag");continue;case _.TEXT_ENTITY:case _.ATTRIB_VALUE_ENTITY_Q:case _.ATTRIB_VALUE_ENTITY_U:var s,u;switch(this.state){case _.TEXT_ENTITY:s=_.TEXT,u="textNode";break;case _.ATTRIB_VALUE_ENTITY_Q:s=_.ATTRIB_VALUE_QUOTED,u="attribValue";break;case _.ATTRIB_VALUE_ENTITY_U:s=_.ATTRIB_VALUE_UNQUOTED,u="attribValue"}";"===i?(this[u]+=k(this),this.entity="",this.state=s):g(this.entity.length?f:p,i)?this.entity+=i:(N(this,"Invalid character in entity name"),this[u]+="&"+this.entity+i,this.entity="",this.state=s);continue;default:throw new Error(this,"Unknown state: "+this.state)}this.position>=this.bufferCheckPosition&&function(e){for(var r=Math.max(t.MAX_BUFFER_LENGTH,10),i=0,o=0,a=n.length;o<a;o++){var s=e[n[o]].length;if(s>r)switch(n[o]){case"textNode":O(e);break;case"cdata":I(e,"oncdata",e.cdata),e.cdata="";break;case"script":I(e,"onscript",e.script),e.script="";break;default:x(e,"Max buffer length exceeded: "+n[o])}i=Math.max(i,s)}var u=t.MAX_BUFFER_LENGTH-i;e.bufferCheckPosition=u+e.position}(this);return this}
/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var t;O(t=this),""!==t.cdata&&(I(t,"oncdata",t.cdata),t.cdata=""),""!==t.script&&(I(t,"onscript",t.script),t.script="")}};try{e=r(4).Stream}catch(t){e=function(){}}var o=t.EVENTS.filter((function(t){return"error"!==t&&"end"!==t}));function a(t,r){if(!(this instanceof a))return new a(t,r);e.apply(this),this._parser=new i(t,r),this.writable=!0,this.readable=!0;var n=this;this._parser.onend=function(){n.emit("end")},this._parser.onerror=function(t){n.emit("error",t),n._parser.error=null},this._decoder=null,o.forEach((function(t){Object.defineProperty(n,"on"+t,{get:function(){return n._parser["on"+t]},set:function(e){if(!e)return n.removeAllListeners(t),n._parser["on"+t]=e,e;n.on(t,e)},enumerable:!0,configurable:!1})}))}a.prototype=Object.create(e.prototype,{constructor:{value:a}}),a.prototype.write=function(t){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(t)){if(!this._decoder){var e=r(25).StringDecoder;this._decoder=new e("utf8")}t=this._decoder.write(t)}return this._parser.write(t.toString()),this.emit("data",t),!0},a.prototype.end=function(t){return t&&t.length&&this.write(t),this._parser.end(),!0},a.prototype.on=function(t,r){var n=this;return n._parser["on"+t]||-1===o.indexOf(t)||(n._parser["on"+t]=function(){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.splice(0,0,t),n.emit.apply(n,e)}),e.prototype.on.call(n,t,r)};var s="http://www.w3.org/XML/1998/namespace",u={xml:s,xmlns:"http://www.w3.org/2000/xmlns/"},c=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,l=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,p=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,f=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function d(t){return" "===t||"\n"===t||"\r"===t||"\t"===t}function h(t){return'"'===t||"'"===t}function m(t){return">"===t||d(t)}function g(t,e){return t.test(e)}function y(t,e){return!g(t,e)}var b,v,w,_=0;for(var E in t.STATE={BEGIN:_++,BEGIN_WHITESPACE:_++,TEXT:_++,TEXT_ENTITY:_++,OPEN_WAKA:_++,SGML_DECL:_++,SGML_DECL_QUOTED:_++,DOCTYPE:_++,DOCTYPE_QUOTED:_++,DOCTYPE_DTD:_++,DOCTYPE_DTD_QUOTED:_++,COMMENT_STARTING:_++,COMMENT:_++,COMMENT_ENDING:_++,COMMENT_ENDED:_++,CDATA:_++,CDATA_ENDING:_++,CDATA_ENDING_2:_++,PROC_INST:_++,PROC_INST_BODY:_++,PROC_INST_ENDING:_++,OPEN_TAG:_++,OPEN_TAG_SLASH:_++,ATTRIB:_++,ATTRIB_NAME:_++,ATTRIB_NAME_SAW_WHITE:_++,ATTRIB_VALUE:_++,ATTRIB_VALUE_QUOTED:_++,ATTRIB_VALUE_CLOSED:_++,ATTRIB_VALUE_UNQUOTED:_++,ATTRIB_VALUE_ENTITY_Q:_++,ATTRIB_VALUE_ENTITY_U:_++,CLOSE_TAG:_++,CLOSE_TAG_SAW_WHITE:_++,SCRIPT:_++,SCRIPT_ENDING:_++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach((function(e){var r=t.ENTITIES[e],n="number"==typeof r?String.fromCharCode(r):r;t.ENTITIES[e]=n})),t.STATE)t.STATE[t.STATE[E]]=E;function T(t,e,r){t[e]&&t[e](r)}function I(t,e,r){t.textNode&&O(t),T(t,e,r)}function O(t){t.textNode=A(t.opt,t.textNode),t.textNode&&T(t,"ontext",t.textNode),t.textNode=""}function A(t,e){return t.trim&&(e=e.trim()),t.normalize&&(e=e.replace(/\s+/g," ")),e}function x(t,e){return O(t),t.trackPosition&&(e+="\nLine: "+t.line+"\nColumn: "+t.column+"\nChar: "+t.c),e=new Error(e),t.error=e,T(t,"onerror",e),t}function S(t){return t.sawRoot&&!t.closedRoot&&N(t,"Unclosed root tag"),t.state!==_.BEGIN&&t.state!==_.BEGIN_WHITESPACE&&t.state!==_.TEXT&&x(t,"Unexpected end"),O(t),t.c="",t.closed=!0,T(t,"onend"),i.call(t,t.strict,t.opt),t}function N(t,e){if("object"!=typeof t||!(t instanceof i))throw new Error("bad call to strictFail");t.strict&&x(t,e)}function D(t){t.strict||(t.tagName=t.tagName[t.looseCase]());var e=t.tags[t.tags.length-1]||t,r=t.tag={name:t.tagName,attributes:{}};t.opt.xmlns&&(r.ns=e.ns),t.attribList.length=0,I(t,"onopentagstart",r)}function R(t,e){var r=t.indexOf(":")<0?["",t]:t.split(":"),n=r[0],i=r[1];return e&&"xmlns"===t&&(n="xmlns",i=""),{prefix:n,local:i}}function F(t){if(t.strict||(t.attribName=t.attribName[t.looseCase]()),-1!==t.attribList.indexOf(t.attribName)||t.tag.attributes.hasOwnProperty(t.attribName))t.attribName=t.attribValue="";else{if(t.opt.xmlns){var e=R(t.attribName,!0),r=e.prefix,n=e.local;if("xmlns"===r)if("xml"===n&&t.attribValue!==s)N(t,"xml: prefix must be bound to "+s+"\nActual: "+t.attribValue);else if("xmlns"===n&&"http://www.w3.org/2000/xmlns/"!==t.attribValue)N(t,"xmlns: prefix must be bound to http://www.w3.org/2000/xmlns/\nActual: "+t.attribValue);else{var i=t.tag,o=t.tags[t.tags.length-1]||t;i.ns===o.ns&&(i.ns=Object.create(o.ns)),i.ns[n]=t.attribValue}t.attribList.push([t.attribName,t.attribValue])}else t.tag.attributes[t.attribName]=t.attribValue,I(t,"onattribute",{name:t.attribName,value:t.attribValue});t.attribName=t.attribValue=""}}function L(t,e){if(t.opt.xmlns){var r=t.tag,n=R(t.tagName);r.prefix=n.prefix,r.local=n.local,r.uri=r.ns[n.prefix]||"",r.prefix&&!r.uri&&(N(t,"Unbound namespace prefix: "+JSON.stringify(t.tagName)),r.uri=n.prefix);var i=t.tags[t.tags.length-1]||t;r.ns&&i.ns!==r.ns&&Object.keys(r.ns).forEach((function(e){I(t,"onopennamespace",{prefix:e,uri:r.ns[e]})}));for(var o=0,a=t.attribList.length;o<a;o++){var s=t.attribList[o],u=s[0],c=s[1],l=R(u,!0),p=l.prefix,f=l.local,d=""===p?"":r.ns[p]||"",h={name:u,value:c,prefix:p,local:f,uri:d};p&&"xmlns"!==p&&!d&&(N(t,"Unbound namespace prefix: "+JSON.stringify(p)),h.uri=p),t.tag.attributes[u]=h,I(t,"onattribute",h)}t.attribList.length=0}t.tag.isSelfClosing=!!e,t.sawRoot=!0,t.tags.push(t.tag),I(t,"onopentag",t.tag),e||(t.noscript||"script"!==t.tagName.toLowerCase()?t.state=_.TEXT:t.state=_.SCRIPT,t.tag=null,t.tagName=""),t.attribName=t.attribValue="",t.attribList.length=0}function P(t){if(!t.tagName)return N(t,"Weird empty close tag."),t.textNode+="</>",void(t.state=_.TEXT);if(t.script){if("script"!==t.tagName)return t.script+="</"+t.tagName+">",t.tagName="",void(t.state=_.SCRIPT);I(t,"onscript",t.script),t.script=""}var e=t.tags.length,r=t.tagName;t.strict||(r=r[t.looseCase]());for(var n=r;e--;){if(t.tags[e].name===n)break;N(t,"Unexpected close tag")}if(e<0)return N(t,"Unmatched closing tag: "+t.tagName),t.textNode+="</"+t.tagName+">",void(t.state=_.TEXT);t.tagName=r;for(var i=t.tags.length;i-- >e;){var o=t.tag=t.tags.pop();t.tagName=t.tag.name,I(t,"onclosetag",t.tagName);var a={};for(var s in o.ns)a[s]=o.ns[s];var u=t.tags[t.tags.length-1]||t;t.opt.xmlns&&o.ns!==u.ns&&Object.keys(o.ns).forEach((function(e){var r=o.ns[e];I(t,"onclosenamespace",{prefix:e,uri:r})}))}0===e&&(t.closedRoot=!0),t.tagName=t.attribValue=t.attribName="",t.attribList.length=0,t.state=_.TEXT}function k(t){var e,r=t.entity,n=r.toLowerCase(),i="";return t.ENTITIES[r]?t.ENTITIES[r]:t.ENTITIES[n]?t.ENTITIES[n]:("#"===(r=n).charAt(0)&&("x"===r.charAt(1)?(r=r.slice(2),i=(e=parseInt(r,16)).toString(16)):(r=r.slice(1),i=(e=parseInt(r,10)).toString(10))),r=r.replace(/^0+/,""),isNaN(e)||i.toLowerCase()!==r?(N(t,"Invalid character entity"),"&"+t.entity+";"):String.fromCodePoint(e))}function C(t,e){"<"===e?(t.state=_.OPEN_WAKA,t.startTagPosition=t.position):d(e)||(N(t,"Non-whitespace before first tag."),t.textNode=e,t.state=_.TEXT)}function j(t,e){var r="";return e<t.length&&(r=t.charAt(e)),r}_=t.STATE,String.fromCodePoint||(b=String.fromCharCode,v=Math.floor,w=function(){var t,e,r=16384,n=[],i=-1,o=arguments.length;if(!o)return"";for(var a="";++i<o;){var s=Number(arguments[i]);if(!isFinite(s)||s<0||s>1114111||v(s)!==s)throw RangeError("Invalid code point: "+s);s<=65535?n.push(s):(t=55296+((s-=65536)>>10),e=s%1024+56320,n.push(t,e)),(i+1===o||n.length>r)&&(a+=b.apply(null,n),n.length=0)}return a},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:w,configurable:!0,writable:!0}):String.fromCodePoint=w)}(e)},function(t,e){t.exports=require("timers")},function(t,e,r){const n=r(7),i=r(29),o=["mp4a","mp3","vorbis","aac","opus","flac"],a=["mp4v","avc1","Sorenson H.283","MPEG-4 Visual","VP8","VP9","H.264"],s=t=>t.bitrate||0,u=t=>a.findIndex(e=>t.codecs&&t.codecs.includes(e)),c=t=>t.audioBitrate||0,l=t=>o.findIndex(e=>t.codecs&&t.codecs.includes(e)),p=(t,e,r)=>{let n=0;for(let i of r)if(n=i(e)-i(t),0!==n)break;return n},f=(t,e)=>p(t,e,[t=>parseInt(t.qualityLabel),s,u]),d=(t,e)=>p(t,e,[c,l]);e.sortFormats=(t,e)=>p(t,e,[t=>+!!t.isHLS,t=>+!!t.isDashMPD,t=>+(t.contentLength>0),t=>+(t.hasVideo&&t.hasAudio),t=>+t.hasVideo,t=>parseInt(t.qualityLabel)||0,s,c,u,l]),e.chooseFormat=(t,r)=>{if("object"==typeof r.format){if(!r.format.url)throw Error("Invalid format given, did you use `ytdl.getInfo()`?");return r.format}let n;r.filter&&(t=e.filterFormats(t,r.filter));const i=r.quality||"highest";switch(i){case"highest":n=t[0];break;case"lowest":n=t[t.length-1];break;case"highestaudio":(t=e.filterFormats(t,"audio")).sort(d),n=t[0];break;case"lowestaudio":(t=e.filterFormats(t,"audio")).sort(d),n=t[t.length-1];break;case"highestvideo":(t=e.filterFormats(t,"video")).sort(f),n=t[0];break;case"lowestvideo":(t=e.filterFormats(t,"video")).sort(f),n=t[t.length-1];break;default:n=h(i,t)}if(!n)throw Error("No such format found: "+i);return n};const h=(t,e)=>{let r=t=>e.find(e=>""+e.itag==""+t);return Array.isArray(t)?r(t.find(t=>r(t))):r(t)};e.filterFormats=(t,e)=>{let r;switch(e){case"videoandaudio":case"audioandvideo":r=t=>t.hasVideo&&t.hasAudio;break;case"video":r=t=>t.hasVideo;break;case"videoonly":r=t=>t.hasVideo&&!t.hasAudio;break;case"audio":r=t=>t.hasAudio;break;case"audioonly":r=t=>!t.hasVideo&&t.hasAudio;break;default:if("function"!=typeof e)throw TypeError(`Given filter (${e}) is not supported`);r=e}return t.filter(t=>!!t.url&&r(t))},e.addFormatMeta=t=>((t=Object.assign({},i[t.itag],t)).hasVideo=!!t.qualityLabel,t.hasAudio=!!t.audioBitrate,t.container=t.mimeType?t.mimeType.split(";")[0].split("/")[1]:null,t.codecs=t.mimeType?n.between(t.mimeType,'codecs="','"'):null,t.videoCodec=t.hasVideo&&t.codecs?t.codecs.split(", ")[0]:null,t.audioCodec=t.hasAudio&&t.codecs?t.codecs.split(", ").slice(-1)[0]:null,t.isLive=/\bsource[/=]yt_live_broadcast\b/.test(t.url),t.isHLS=/\/manifest\/hls_(variant|playlist)\//.test(t.url),t.isDashMPD=/\/manifest\/dash\//.test(t.url),t)},function(t,e,r){const n=r(0),i=new Set(["youtube.com","www.youtube.com","m.youtube.com","music.youtube.com","gaming.youtube.com"]),o=/^https?:\/\/(youtu\.be\/|(www\.)?youtube.com\/(embed|v)\/)/;e.getURLVideoID=t=>{const r=n.parse(t,!0);let s=r.query.v;if(o.test(t)&&!s){const t=r.pathname.split("/");s=t[t.length-1]}else if(r.hostname&&!i.has(r.hostname))throw Error("Not a YouTube domain");if(!s)throw Error("No video id found: "+t);if(s=s.substring(0,11),!e.validateID(s))throw TypeError(`Video id (${s}) does not match expected format (${a.toString()})`);return s},e.getVideoID=t=>e.validateID(t)?t:e.getURLVideoID(t);const a=/^[a-zA-Z0-9-_]{11}$/;e.validateID=t=>a.test(t),e.validateURL=t=>{try{return e.getURLVideoID(t),!0}catch(t){return!1}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.durationStr=e.humanStr=void 0;const n=/^\d+$/,i=/^(?:(?:(\d+):)?(\d{1,2}):)?(\d{1,2})(?:\.(\d{3}))?$/,o={ms:1,s:1e3,m:6e4,h:36e5};e.humanStr=t=>{if("number"==typeof t)return t;if(n.test(t))return+t;const e=i.exec(t);if(e)return+(e[1]||0)*o.h+ +(e[2]||0)*o.m+ +e[3]*o.s+ +(e[4]||0);{let e=0;const r=/(-?\d+)(ms|s|m|h)/g;let n;for(;null!=(n=r.exec(t));)e+=+n[1]*o[n[2]];return e}},e.durationStr=t=>{let e=0;const r=/(\d+(?:\.\d+)?)(S|M|H)/g;let n;for(;null!=(n=r.exec(t));)e+=+n[1]*o[n[2].toLowerCase()];return e}},function(t,e,r){const n=r(0),i=r(5),o=r(6),a=r(18);e.cache=new a,e.getTokens=(t,r)=>e.cache.getOrSet(t,async()=>{let n=await i(t,r.requestOptions).text();const o=e.extractActions(n);if(!o||!o.length)throw Error("Could not extract signature deciphering actions");return e.cache.set(t,o),o}),e.decipher=(t,e)=>{e=e.split("");for(let r=0,n=t.length;r<n;r++){let n,i=t[r];switch(i[0]){case"r":e=e.reverse();break;case"w":n=~~i.slice(1),e=s(e,n);break;case"s":n=~~i.slice(1),e=e.slice(n);break;case"p":n=~~i.slice(1),e.splice(0,n)}}return e.join("")};const s=(t,e)=>{const r=t[0];return t[0]=t[e%t.length],t[e]=r,t},u="[a-zA-Z_\\$][a-zA-Z_0-9]*",c="(?:'[^'\\\\]*(:?\\\\[\\s\\S][^'\\\\]*)*'|\"[^\"\\\\]*(:?\\\\[\\s\\S][^\"\\\\]*)*\")",l=`(?:${u}|${c})`,p=`(?:\\.${u}|\\[${c}\\])`,f=":function\\(a\\)\\{(?:return )?a\\.reverse\\(\\)\\}",d=":function\\(a,b\\)\\{return a\\.slice\\(b\\)\\}",h=":function\\(a,b\\)\\{a\\.splice\\(0,b\\)\\}",m=":function\\(a,b\\)\\{var c=a\\[0\\];a\\[0\\]=a\\[b(?:%a\\.length)?\\];a\\[b(?:%a\\.length)?\\]=c(?:;return a)?\\}",g=new RegExp(`var (${u})=\\{((?:(?:${l}${f}|${l}${d}|${l}${h}|${l}${m}),?\\r?\\n?)+)\\};`),y=new RegExp(`function(?: ${u})?\\(a\\)\\{a=a\\.split\\((?:''|"")\\);\\s*((?:(?:a=)?[a-zA-Z_\\$][a-zA-Z_0-9]*${p}\\(a,\\d+\\);)+)return a\\.join\\((?:''|"")\\)\\}`),b=new RegExp(`(?:^|,)(${l})${f}`,"m"),v=new RegExp(`(?:^|,)(${l})${d}`,"m"),w=new RegExp(`(?:^|,)(${l})${h}`,"m"),_=new RegExp(`(?:^|,)(${l})${m}`,"m");e.extractActions=t=>{const e=g.exec(t),r=y.exec(t);if(!e||!r)return null;const n=e[1].replace(/\$/g,"\\$"),i=e[2].replace(/\$/g,"\\$"),o=r[1].replace(/\$/g,"\\$");let a=b.exec(i);const s=a&&a[1].replace(/\$/g,"\\$").replace(/\$|^'|^"|'$|"$/g,"");a=v.exec(i);const u=a&&a[1].replace(/\$/g,"\\$").replace(/\$|^'|^"|'$|"$/g,"");a=w.exec(i);const c=a&&a[1].replace(/\$/g,"\\$").replace(/\$|^'|^"|'$|"$/g,"");a=_.exec(i);const l=a&&a[1].replace(/\$/g,"\\$").replace(/\$|^'|^"|'$|"$/g,""),p=`(${[s,u,c,l].join("|")})`,f=new RegExp(`(?:a=)?${n}(?:\\.${p}|\\['${p}'\\]|\\["${p}"\\])\\(a,(\\d+)\\)`,"g"),d=[];for(;null!==(a=f.exec(o));){switch(a[1]||a[2]||a[3]){case l:d.push("w"+a[4]);break;case s:d.push("r");break;case u:d.push("s"+a[4]);break;case c:d.push("p"+a[4])}}return d},e.setDownloadURL=(t,e)=>{let r;if(!t.url)return;r=t.url;try{r=decodeURIComponent(r)}catch(t){return}const i=n.parse(r,!0);delete i.search;let o=i.query;o.ratebypass="yes",e&&(o[t.sp||"signature"]=e),t.url=n.format(i)},e.decipherFormats=async(t,r,n)=>{let i={},a=await e.getTokens(r,n);return t.forEach(t=>{let r=t.signatureCipher||t.cipher;r&&(Object.assign(t,o.parse(r)),delete t.signatureCipher,delete t.cipher);const n=a&&t.s?e.decipher(a,t.s):null;e.setDownloadURL(t,n),i[t.url]=t}),i}},function(t,e,r){const{setTimeout:n}=r(13);t.exports=class extends Map{constructor(t=1e3){super(),this.timeout=t}set(t,e){this.has(t)&&clearTimeout(super.get(t).tid),super.set(t,{tid:n(this.delete.bind(this,t),this.timeout).unref(),value:e})}get(t){let e=super.get(t);return e?e.value:null}getOrSet(t,e){if(this.has(t))return this.get(t);{let r=e();return this.set(t,r),(async()=>{try{await r}catch(e){this.delete(t)}})(),r}}delete(t){let e=super.get(t);e&&(clearTimeout(e.tid),super.delete(t))}clear(){for(let t of this.values())clearTimeout(t.tid);super.clear()}}},function(t,e,r){const n=r(0),i=r(5),o={limit:100},a={gl:"US",hl:"en"},s={client:{utcOffsetMinutes:0,gl:"US",hl:"en",clientName:"WEB",clientVersion:"<important information>"},user:{},request:{}};e.parseBody=(t,e={})=>{const r=c(t,'window["ytInitialData"] = ')||c(t,"var ytInitialData = "),n=l(t,'INNERTUBE_API_KEY":"','"')||l(t,'innertubeApiKey":"','"'),i=l(t,'INNERTUBE_CONTEXT_CLIENT_VERSION":"','"')||l(t,'innertube_context_client_version":"','"'),o=JSON.parse(JSON.stringify(s));return o.client.clientVersion=i,e.gl&&(o.client.gl=e.gl),e.hl&&(o.client.hl=e.hl),e.utcOffsetMinutes&&(o.client.utcOffsetMinutes=e.utcOffsetMinutes),{json:r,apiKey:n,context:o}};const u=e.parseText=t=>t.simpleText||t.runs.map(t=>t.text).join("");e.parseIntegerFromText=t=>Number(u(t).replace(/\D+/g,"")),e.doPost=async(t,e,r={})=>{r.method="POST";const n=i(t,r);return e&&n.once("request",t=>t.write(JSON.stringify(e))),JSON.parse(await n.text())},e.checkArgs=(t,e={})=>{if(!t)throw new Error("playlist ID is mandatory");if("string"!=typeof t)throw new Error("playlist ID must be of type string");const r=Object.assign({},o,e);return!isNaN(r.pages)&&r.pages>0?r.limit=1/0:(isNaN(r.limit)||r.limit<=0)&&(r.pages=1/0,r.limit=o.limit),r.query={list:t},r.query=Object.assign({},a,r.query),e&&e.gl&&(r.query.gl=e.gl),e&&e.hl&&(r.query.hl=e.hl),r.requestOptions=Object.assign({},e.requestOptions),r.requestOptions.headers&&(r.requestOptions.headers=JSON.parse(JSON.stringify(r.requestOptions.headers))),r},e.prepImg=t=>(t.forEach(t=>t.url=t.url?n.resolve("https://www.youtube.com/",t.url):null),t.sort((t,e)=>e.width-t.width));const c=(t,e)=>{const r=t.indexOf(e);if(-1===r)return null;t=t.slice(r+e.length);try{return JSON.parse(p(t))}catch(t){return null}},l=(t,e,r)=>{let n;return n=t.indexOf(e),-1===n?"":(n+=e.length,n=(t=t.slice(n)).indexOf(r),-1===n?"":t=t.slice(0,n))},p=e.cutAfterJSON=t=>{let e,r;if("["===t[0]?(e="[",r="]"):"{"===t[0]&&(e="{",r="}"),!e)throw new Error("Can't cut unsupported JSON (need to begin with [ or { ) but got: "+t[0]);let n,i=!1,o=0;for(n=0;n<t.length;n++)if('"'!==t[n]||"\\"===t[n-1]){if(!i&&(t[n]===e?o++:t[n]===r&&o--,0===o))return t.substr(0,n+1)}else i=!i;throw Error("Can't cut unsupported JSON (no matching closing bracket found)")};e._hidden={jsonAfter:c,between:l,cutAfterJSON:p}},function(t){t.exports=JSON.parse('{"_from":"ytpl","_id":"ytpl@2.0.4","_inBundle":false,"_integrity":"sha512-lXm3LvFvs2RixD6PTDay5jXRhaMSo/Upw7P60/FgQFvNrgSYRwMpR3nB1v3scu84R2XcS6kuENhPD2M4x/920A==","_location":"/ytpl","_phantomChildren":{},"_requested":{"type":"tag","registry":true,"raw":"ytpl","name":"ytpl","escapedName":"ytpl","rawSpec":"","saveSpec":null,"fetchSpec":"latest"},"_requiredBy":["#USER","/"],"_resolved":"https://registry.npmjs.org/ytpl/-/ytpl-2.0.4.tgz","_shasum":"24188190f627d328146542b6cf093c770ae947b7","_spec":"ytpl","_where":"D:\\\\Programming\\\\Electron\\\\YoutubeDownloaderAngular","author":{"name":"Tobias Kutscha","url":"https://github.com/TimeForANinja"},"bugs":{"url":"https://github.com/TimeForANinja/node-ytpl/issues"},"bundleDependencies":false,"dependencies":{"miniget":"^4.1.0"},"deprecated":false,"description":"Anonymous YouTube playlist resolver.","devDependencies":{"assert-diff":"^3.0.1","codecov":"^3.8.1","dtslint":"^4.0.6","eslint":"^7.14.0","mocha":"^8.2.1","nock":"^13.0.5","nyc":"^15.1.0","tslint":"^6.1.3","typescript":"^4.1.2"},"engines":{"node":">=8"},"files":["lib","typings"],"homepage":"https://github.com/TimeForANinja/node-ytpl#readme","keywords":["youtube","yt","video","videos","api","playlist","pl","scrape","pagination","promise"],"license":"MIT","main":"./lib/main.js","name":"ytpl","repository":{"type":"git","url":"git://github.com/TimeForANinja/node-ytpl.git"},"scripts":{"lint":"eslint ./","lint:fix":"eslint --fix ./","lint:typings":"tslint typings/index.d.ts","lint:typings:fix":"tslint --fix typings/index.d.ts","mocha":"mocha -- -t 16000 test/*-test.js","mocha:coverage":"mocha -- -t 16000 test/*-test.js --exclude test/e2e-test.js","nyc":"nyc --reporter=lcov npm run-script mocha","nyc:coverage":"nyc --reporter=lcov npm run-script mocha:coverage","test":"npm run-script nyc","test:coverage":"npm run-script nyc:coverage && codecov"},"types":"./typings/index.d.ts","version":"2.0.4"}')},function(t,e){t.exports=require("os")},function(t,e,r){"use strict";r.r(e);var n=r(8),i=r.n(n);window.ytdl=r(23),window.ytpl=r(34);let o=r(37).path;process.env.npm_lifecycle_script?(o=o.replace("electron\\dist\\resources\\electron.asar\\renderer","ffmpeg-static-electron"),i.a.setFfmpegPath(o)):(o=o.replace("frontend","node_modules\\ffmpeg-static-electron"),i.a.setFfmpegPath(o.replace("app.asar","app.asar.unpacked"))),window.ffmpeg=i.a,window.fs=r(3)},function(t,e,r){const n=r(4).PassThrough,i=r(24),o=r(7),a=r(14),s=r(15),u=r(17),c=r(5),l=r(9),{parseTimestamp:p}=r(9),f=(t,e)=>{const r=d(e);return f.getInfo(t,e).then(t=>{m(r,t,e)},r.emit.bind(r,"error")),r};t.exports=f,f.getBasicInfo=i.getBasicInfo,f.getInfo=i.getInfo,f.chooseFormat=a.chooseFormat,f.filterFormats=a.filterFormats,f.validateID=s.validateID,f.validateURL=s.validateURL,f.getURLVideoID=s.getURLVideoID,f.getVideoID=s.getVideoID,f.cache={sig:u.cache,info:i.cache,watch:i.watchPageCache,cookie:i.cookieCache};const d=t=>{const e=new n({highWaterMark:t&&t.highWaterMark||524288});return e._destroy=()=>{e.destroyed=!0},e},h=(t,e,r)=>{["abort","request","response","error","redirect","retry","reconnect"].forEach(r=>{t.prependListener(r,e.emit.bind(e,r))}),t.pipe(e,{end:r})},m=(t,e,r)=>{r=r||{};let n,i=o.playError(e.player_response,["UNPLAYABLE","LIVE_STREAM_OFFLINE","LOGIN_REQUIRED"]);if(i)return void t.emit("error",i);if(!e.formats.length)return void t.emit("error",Error("This video is unavailable"));try{n=a.chooseFormat(e.formats,r)}catch(e){return void t.emit("error",e)}if(t.emit("info",e,n),t.destroyed)return;let s,u=0;const f=e=>{u+=e.length,t.emit("progress",e.length,u,s)},d=r.dlChunkSize||10485760;let m,g=!0;if(n.isHLS||n.isDashMPD)m=l(n.url,{chunkReadahead:+e.live_chunk_readahead,begin:r.begin||n.isLive&&Date.now(),liveBuffer:r.liveBuffer,requestOptions:r.requestOptions,parser:n.isDashMPD?"dash-mpd":"m3u8",id:n.itag}),m.on("progress",(e,r)=>{t.emit("progress",e.size,e.num,r)}),h(m,t,g);else{const e=Object.assign({},r.requestOptions,{maxReconnects:6,maxRetries:3,backoff:{inc:500,max:1e4}});if(!(0===d||n.hasAudio&&n.hasVideo)){let i=r.range&&r.range.start||0,o=i+d;const a=r.range&&r.range.end;s=r.range?(a?a+1:parseInt(n.contentLength))-i:parseInt(n.contentLength);const u=()=>{!a&&o>=s&&(o=0),a&&o>a&&(o=a),g=!o||o===a,e.headers=Object.assign({},e.headers,{Range:`bytes=${i}-${o||""}`}),m=c(n.url,e),m.on("data",f),m.on("end",()=>{t.destroyed||o&&o!==a&&(i=o+1,o+=d,u())}),h(m,t,g)};u()}else r.begin&&(n.url+="&begin="+p(r.begin)),r.range&&(r.range.start||r.range.end)&&(e.headers=Object.assign({},e.headers,{Range:`bytes=${r.range.start||"0"}-${r.range.end||""}`})),m=c(n.url,e),m.on("response",e=>{t.destroyed||(s=s||parseInt(e.headers["content-length"]))}),m.on("data",f),h(m,t,g)}t._destroy=()=>{t.destroyed=!0,m.destroy(),m.end()}};f.downloadFromInfo=(t,e)=>{const r=d(e);if(!t.full)throw Error("Cannot use `ytdl.downloadFromInfo()` when called with info from `ytdl.getBasicInfo()`");return setImmediate(()=>{m(r,t,e)}),r}},function(t,e,r){const n=r(0),i=r(6),o=r(12),a=r(5),s=r(7),{setTimeout:u}=r(13),c=r(14),l=r(15),p=r(30),f=r(17),d=r(18),h="https://www.youtube.com/watch?v=";e.cache=new d,e.cookieCache=new d(864e5),e.watchPageCache=new d;class m extends Error{}const g=["support.google.com/youtube/?p=age_restrictions","youtube.com/t/community_guidelines"];e.getBasicInfo=async(t,e)=>{const r=Object.assign({},a.defaultOptions,e.requestOptions);e.requestOptions=Object.assign({},e.requestOptions,{}),e.requestOptions.headers=Object.assign({},{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.101 Safari/537.36"},e.requestOptions.headers);let n=await T([t,e],t=>{let e=s.playError(t.player_response,["ERROR"],m),r=y(t.player_response);if(e||r)throw e||r;return t&&t.player_response&&(t.player_response.streamingData||b(t.player_response)||v(t.player_response))},r,[R,D,F]);Object.assign(n,{formats:L(n.player_response),related_videos:p.getRelatedVideos(n)});const i=p.getMedia(n);let o={author:p.getAuthor(n),media:i,likes:p.getLikes(n),dislikes:p.getDislikes(n),age_restricted:!!(i&&i.notice_url&&g.some(t=>i.notice_url.includes(t))),video_url:h+t,storyboards:p.getStoryboards(n)};return n.videoDetails=p.cleanVideoDetails(Object.assign({},n.player_response&&n.player_response.microformat&&n.player_response.microformat.playerMicroformatRenderer,n.player_response&&n.player_response.videoDetails,o)),n};const y=t=>{let e=t&&t.playabilityStatus;return e&&"LOGIN_REQUIRED"===e.status&&e.messages&&e.messages.filter(t=>/This is a private video/.test(t)).length?new m(e.reason||e.messages&&e.messages[0]):null},b=t=>{let e=t.playabilityStatus;return e&&"UNPLAYABLE"===e.status&&e.errorScreen&&e.errorScreen.playerLegacyDesktopYpcOfferRenderer},v=t=>{let e=t.playabilityStatus;return e&&"LIVE_STREAM_OFFLINE"===e.status},w=(t,e)=>`${h+t}&hl=${e.lang||"en"}`,_=(t,r)=>{const n=w(t,r);return e.watchPageCache.getOrSet(n,()=>a(n,r.requestOptions).text())},E=t=>{let e=/<script\s+src="([^"]+)"(?:\s+type="text\/javascript")?\s+name="player_ias\/base"\s*>|"jsUrl":"([^"]+)"/.exec(t);return e?e[1]||e[2]:null},T=async(t,e,r,n)=>{let i;for(let o of n)try{const n=await O(o,t.concat([i]),r);if(n.player_response&&(n.player_response.videoDetails=I(i&&i.player_response&&i.player_response.videoDetails,n.player_response.videoDetails),n.player_response=I(i&&i.player_response,n.player_response)),i=I(i,n),e(i,!1))break}catch(t){if(t instanceof m||o===n[n.length-1])throw t}return i},I=(t,e)=>{if(!t||!e)return t||e;for(let[r,n]of Object.entries(e))null!=n&&(t[r]=n);return t},O=async(t,e,r)=>{let n,i=0;for(;i<=r.maxRetries;)try{n=await t(...e);break}catch(t){if(t instanceof m||t instanceof a.MinigetError&&t.statusCode<500||i>=r.maxRetries)throw t;let e=Math.min(++i*r.backoff.inc,r.backoff.max);await new Promise(t=>u(t,e))}return n},A=/^[)\]}'\s]+/,x=(t,e,r)=>{if(!r||"object"==typeof r)return r;try{return r=r.replace(A,""),JSON.parse(r)}catch(r){throw Error(`Error parsing ${e} in ${t}: ${r.message}`)}},S=(t,e,r,n,i,o)=>{let a=s.between(r,n,i);if(!a)throw Error(`Could not find ${e} in ${t}`);return x(t,e,s.cutAfterJSON(`${o}${a}`))},N=(t,e)=>{const r=e&&(e.args&&e.args.player_response||e.player_response||e.playerResponse||e.embedded_player_response);return x(t,"player_response",r)},D=async(t,r)=>{const n=Object.assign({headers:{}},r.requestOptions);let i=n.headers.Cookie||n.headers.cookie;n.headers=Object.assign({"x-youtube-client-name":"1","x-youtube-client-version":"2.20201203.06.00","x-youtube-identity-token":e.cookieCache.get(i||"browser")||""},n.headers);const o=async(i,o)=>{n.headers["x-youtube-identity-token"]||(n.headers["x-youtube-identity-token"]=await((t,r,n,i)=>e.cookieCache.getOrSet(n,async()=>{let e=(await _(t,r)).match(/(["'])ID_TOKEN\1[:,]\s?"([^"]+)"/);if(!e&&i)throw new m("Cookie header used in request, but unable to find YouTube identity token");return e&&e[2]}))(t,r,i,o))};i&&await o(i,!0);const s=((t,e)=>w(t,e)+"&pbj=1")(t,r);let u=await a(s,n).text(),c=x("watch.json","body",u);if("now"===c.reload&&await o("browser",!1),"now"===c.reload||!Array.isArray(c))throw Error("Unable to retrieve video metadata in watch.json");let l=c.reduce((t,e)=>Object.assign(e,t),{});return l.player_response=N("watch.json",l),l.html5player=l.player&&l.player.assets&&l.player.assets.js,l},R=async(t,e)=>{let r=await _(t,e),n={page:"watch"};try{n.player_response=S("watch.html","player_response",r,/\bytInitialPlayerResponse\s*=\s*\{/i,"\n","{")}catch(t){let e=S("watch.html","player_response",r,/\bytplayer\.config\s*=\s*{/,"<\/script>","{");n.player_response=N("watch.html",e)}return n.response=S("watch.html","response",r,/\bytInitialData("\])?\s*=\s*\{/i,"\n","{"),n.html5player=E(r),n},F=async(t,e)=>{const r=n.format({protocol:"https",host:"www.youtube.com",pathname:"/get_video_info",query:{video_id:t,eurl:"https://youtube.googleapis.com/v/"+t,ps:"default",gl:"US",hl:e.lang||"en"}});let o=await a(r,e.requestOptions).text(),s=i.parse(o);return s.player_response=N("get_video_info",s),s},L=t=>{let e=[];return t&&t.streamingData&&(e=e.concat(t.streamingData.formats||[]).concat(t.streamingData.adaptiveFormats||[])),e};e.getInfo=async(t,r)=>{let i=await e.getBasicInfo(t,r);const o=i.player_response&&i.player_response.streamingData&&(i.player_response.streamingData.dashManifestUrl||i.player_response.streamingData.hlsManifestUrl);let s=[];if(i.formats.length){if(i.html5player=i.html5player||E(await _(t,r))||E(await((t,e)=>{const r=`${"https://www.youtube.com/embed/"+t}?hl=${e.lang||"en"}`;return a(r,e.requestOptions).text()})(t,r)),!i.html5player)throw Error("Unable to find html5player file");const e=n.resolve(h,i.html5player);s.push(f.decipherFormats(i.formats,e,r))}if(o&&i.player_response.streamingData.dashManifestUrl){let t=i.player_response.streamingData.dashManifestUrl;s.push(P(t,r))}if(o&&i.player_response.streamingData.hlsManifestUrl){let t=i.player_response.streamingData.hlsManifestUrl;s.push(k(t,r))}let u=await Promise.all(s);return i.formats=Object.values(Object.assign({},...u)),i.formats=i.formats.map(c.addFormatMeta),i.formats.sort(c.sortFormats),i.full=!0,i};const P=(t,e)=>new Promise((r,i)=>{let s={};const u=o.parser(!1);let c;u.onerror=i,u.onopentag=e=>{if("ADAPTATIONSET"===e.name)c=e.attributes;else if("REPRESENTATION"===e.name){const r=parseInt(e.attributes.ID);isNaN(r)||(s[t]=Object.assign({itag:r,url:t,bitrate:parseInt(e.attributes.BANDWIDTH),mimeType:`${c.MIMETYPE}; codecs="${e.attributes.CODECS}"`},e.attributes.HEIGHT?{width:parseInt(e.attributes.WIDTH),height:parseInt(e.attributes.HEIGHT),fps:parseInt(e.attributes.FRAMERATE)}:{audioSampleRate:e.attributes.AUDIOSAMPLINGRATE}))}},u.onend=()=>{r(s)};const l=a(n.resolve(h,t),e.requestOptions);l.setEncoding("utf8"),l.on("error",i),l.on("data",t=>{u.write(t)}),l.on("end",u.close.bind(u))}),k=async(t,e)=>{t=n.resolve(h,t);let r=await a(t,e.requestOptions).text(),i={};return r.split("\n").filter(t=>/^https?:\/\//.test(t)).forEach(t=>{const e=parseInt(t.match(/\/itag\/(\d+)\//)[1]);i[t]={itag:e,url:t}}),i};for(let t of["getBasicInfo","getInfo"]){const r=e[t];e[t]=async(n,i={})=>{s.checkForUpdates();let o=await l.getVideoID(n);const a=[t,o,i.lang].join("-");return e.cache.getOrSet(a,()=>r(o,i))}}e.validateID=l.validateID,e.validateURL=l.validateURL,e.getURLVideoID=l.getURLVideoID,e.getVideoID=l.getVideoID},function(t,e){t.exports=require("string_decoder")},function(t,e){t.exports=require("http")},function(t,e){t.exports=require("https")},function(t){t.exports=JSON.parse('{"_from":"ytdl-core@latest","_id":"ytdl-core@4.4.2","_inBundle":false,"_integrity":"sha512-T6eXIhDoDPqmxFKPu4R2LG+X/uWYh1wy/cfAf+OwJNHx6+cAYXbdyZ8j2el9yy1G3nDP1Dd4YN5BGRATJdQlFg==","_location":"/ytdl-core","_phantomChildren":{},"_requested":{"type":"tag","registry":true,"raw":"ytdl-core@latest","name":"ytdl-core","escapedName":"ytdl-core","rawSpec":"latest","saveSpec":null,"fetchSpec":"latest"},"_requiredBy":["#USER","/"],"_resolved":"https://registry.npmjs.org/ytdl-core/-/ytdl-core-4.4.2.tgz","_shasum":"8bfa80477797a2747ae5b09273548b5e0c6b115e","_spec":"ytdl-core@latest","_where":"D:\\\\Programming\\\\Electron\\\\YoutubeDownloaderAngular","author":{"name":"fent","email":"fentbox@gmail.com","url":"https://github.com/fent"},"bugs":{"url":"https://github.com/fent/node-ytdl-core/issues"},"bundleDependencies":false,"contributors":[{"name":"Tobias Kutscha","url":"https://github.com/TimeForANinja"},{"name":"Andrew Kelley","url":"https://github.com/andrewrk"},{"name":"Mauricio Allende","url":"https://github.com/mallendeo"},{"name":"Rodrigo Altamirano","url":"https://github.com/raltamirano"},{"name":"Jim Buck","url":"https://github.com/JimmyBoh"}],"dependencies":{"m3u8stream":"^0.8.3","miniget":"^4.0.0","sax":"^1.1.3"},"deprecated":false,"description":"YouTube video downloader in pure javascript.","devDependencies":{"@types/node":"^13.1.0","assert-diff":"^3.0.1","dtslint":"^3.6.14","eslint":"^6.8.0","mocha":"^7.0.0","muk-require":"^1.2.0","nock":"^13.0.4","nyc":"^15.0.0","sinon":"^9.0.0","stream-equal":"~1.1.0","typescript":"^3.9.7"},"engines":{"node":">=10"},"files":["lib","typings"],"homepage":"https://github.com/fent/node-ytdl-core#readme","keywords":["youtube","video","download"],"license":"MIT","main":"./lib/index.js","name":"ytdl-core","repository":{"type":"git","url":"git://github.com/fent/node-ytdl-core.git"},"scripts":{"lint":"eslint ./","lint:fix":"eslint --fix ./","lint:typings":"tslint typings/index.d.ts","lint:typings:fix":"tslint --fix typings/index.d.ts","test":"nyc --reporter=lcov --reporter=text-summary npm run test:unit","test:irl":"mocha --timeout 16000 test/irl-test.js","test:unit":"mocha --ignore test/irl-test.js test/*-test.js --timeout 4000"},"types":"./typings/index.d.ts","version":"4.4.2"}')},function(t,e){t.exports={5:{mimeType:'video/flv; codecs="Sorenson H.283, mp3"',qualityLabel:"240p",bitrate:25e4,audioBitrate:64},6:{mimeType:'video/flv; codecs="Sorenson H.263, mp3"',qualityLabel:"270p",bitrate:8e5,audioBitrate:64},13:{mimeType:'video/3gp; codecs="MPEG-4 Visual, aac"',qualityLabel:null,bitrate:5e5,audioBitrate:null},17:{mimeType:'video/3gp; codecs="MPEG-4 Visual, aac"',qualityLabel:"144p",bitrate:5e4,audioBitrate:24},18:{mimeType:'video/mp4; codecs="H.264, aac"',qualityLabel:"360p",bitrate:5e5,audioBitrate:96},22:{mimeType:'video/mp4; codecs="H.264, aac"',qualityLabel:"720p",bitrate:2e6,audioBitrate:192},34:{mimeType:'video/flv; codecs="H.264, aac"',qualityLabel:"360p",bitrate:5e5,audioBitrate:128},35:{mimeType:'video/flv; codecs="H.264, aac"',qualityLabel:"480p",bitrate:8e5,audioBitrate:128},36:{mimeType:'video/3gp; codecs="MPEG-4 Visual, aac"',qualityLabel:"240p",bitrate:175e3,audioBitrate:32},37:{mimeType:'video/mp4; codecs="H.264, aac"',qualityLabel:"1080p",bitrate:3e6,audioBitrate:192},38:{mimeType:'video/mp4; codecs="H.264, aac"',qualityLabel:"3072p",bitrate:35e5,audioBitrate:192},43:{mimeType:'video/webm; codecs="VP8, vorbis"',qualityLabel:"360p",bitrate:5e5,audioBitrate:128},44:{mimeType:'video/webm; codecs="VP8, vorbis"',qualityLabel:"480p",bitrate:1e6,audioBitrate:128},45:{mimeType:'video/webm; codecs="VP8, vorbis"',qualityLabel:"720p",bitrate:2e6,audioBitrate:192},46:{mimeType:'audio/webm; codecs="vp8, vorbis"',qualityLabel:"1080p",bitrate:null,audioBitrate:192},82:{mimeType:'video/mp4; codecs="H.264, aac"',qualityLabel:"360p",bitrate:5e5,audioBitrate:96},83:{mimeType:'video/mp4; codecs="H.264, aac"',qualityLabel:"240p",bitrate:5e5,audioBitrate:96},84:{mimeType:'video/mp4; codecs="H.264, aac"',qualityLabel:"720p",bitrate:2e6,audioBitrate:192},85:{mimeType:'video/mp4; codecs="H.264, aac"',qualityLabel:"1080p",bitrate:3e6,audioBitrate:192},91:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"144p",bitrate:1e5,audioBitrate:48},92:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"240p",bitrate:15e4,audioBitrate:48},93:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"360p",bitrate:5e5,audioBitrate:128},94:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"480p",bitrate:8e5,audioBitrate:128},95:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"720p",bitrate:15e5,audioBitrate:256},96:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"1080p",bitrate:25e5,audioBitrate:256},100:{mimeType:'audio/webm; codecs="VP8, vorbis"',qualityLabel:"360p",bitrate:null,audioBitrate:128},101:{mimeType:'audio/webm; codecs="VP8, vorbis"',qualityLabel:"360p",bitrate:null,audioBitrate:192},102:{mimeType:'audio/webm; codecs="VP8, vorbis"',qualityLabel:"720p",bitrate:null,audioBitrate:192},120:{mimeType:'video/flv; codecs="H.264, aac"',qualityLabel:"720p",bitrate:2e6,audioBitrate:128},127:{mimeType:'audio/ts; codecs="aac"',qualityLabel:null,bitrate:null,audioBitrate:96},128:{mimeType:'audio/ts; codecs="aac"',qualityLabel:null,bitrate:null,audioBitrate:96},132:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"240p",bitrate:15e4,audioBitrate:48},133:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"240p",bitrate:2e5,audioBitrate:null},134:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"360p",bitrate:3e5,audioBitrate:null},135:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"480p",bitrate:5e5,audioBitrate:null},136:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"720p",bitrate:1e6,audioBitrate:null},137:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"1080p",bitrate:25e5,audioBitrate:null},138:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"4320p",bitrate:135e5,audioBitrate:null},139:{mimeType:'audio/mp4; codecs="aac"',qualityLabel:null,bitrate:null,audioBitrate:48},140:{mimeType:'audio/m4a; codecs="aac"',qualityLabel:null,bitrate:null,audioBitrate:128},141:{mimeType:'audio/mp4; codecs="aac"',qualityLabel:null,bitrate:null,audioBitrate:256},151:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"720p",bitrate:5e4,audioBitrate:24},160:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"144p",bitrate:1e5,audioBitrate:null},171:{mimeType:'audio/webm; codecs="vorbis"',qualityLabel:null,bitrate:null,audioBitrate:128},172:{mimeType:'audio/webm; codecs="vorbis"',qualityLabel:null,bitrate:null,audioBitrate:192},242:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"240p",bitrate:1e5,audioBitrate:null},243:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"360p",bitrate:25e4,audioBitrate:null},244:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"480p",bitrate:5e5,audioBitrate:null},247:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"720p",bitrate:7e5,audioBitrate:null},248:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"1080p",bitrate:15e5,audioBitrate:null},249:{mimeType:'audio/webm; codecs="opus"',qualityLabel:null,bitrate:null,audioBitrate:48},250:{mimeType:'audio/webm; codecs="opus"',qualityLabel:null,bitrate:null,audioBitrate:64},251:{mimeType:'audio/webm; codecs="opus"',qualityLabel:null,bitrate:null,audioBitrate:160},264:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"1440p",bitrate:4e6,audioBitrate:null},266:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"2160p",bitrate:125e5,audioBitrate:null},271:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"1440p",bitrate:9e6,audioBitrate:null},272:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"4320p",bitrate:2e7,audioBitrate:null},278:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"144p 30fps",bitrate:8e4,audioBitrate:null},298:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"720p",bitrate:3e6,audioBitrate:null},299:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"1080p",bitrate:55e5,audioBitrate:null},300:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"720p",bitrate:1318e3,audioBitrate:48},302:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"720p HFR",bitrate:25e5,audioBitrate:null},303:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"1080p HFR",bitrate:5e6,audioBitrate:null},308:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"1440p HFR",bitrate:1e7,audioBitrate:null},313:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"2160p",bitrate:13e6,audioBitrate:null},315:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"2160p HFR",bitrate:2e7,audioBitrate:null},330:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"144p HDR, HFR",bitrate:8e4,audioBitrate:null},331:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"240p HDR, HFR",bitrate:1e5,audioBitrate:null},332:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"360p HDR, HFR",bitrate:25e4,audioBitrate:null},333:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"240p HDR, HFR",bitrate:5e5,audioBitrate:null},334:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"720p HDR, HFR",bitrate:1e6,audioBitrate:null},335:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"1080p HDR, HFR",bitrate:15e5,audioBitrate:null},336:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"1440p HDR, HFR",bitrate:5e6,audioBitrate:null},337:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"2160p HDR, HFR",bitrate:12e6,audioBitrate:null}}},function(t,e,r){const n=r(7),i=r(6),o=r(0),{parseTimestamp:a}=r(9),s="https://www.youtube.com/watch?v=",u={song:{name:"Music",url:"https://music.youtube.com/"}},c=t=>t?t.runs?t.runs[0].text:t.simpleText:null;e.getMedia=t=>{let e={},r=[];try{r=t.response.contents.twoColumnWatchNextResults.results.results.contents}catch(t){}let n=r.find(t=>t.videoSecondaryInfoRenderer);if(!n)return{};try{let t=(n.metadataRowContainer||n.videoSecondaryInfoRenderer.metadataRowContainer).metadataRowContainerRenderer.rows;for(let r of t)if(r.metadataRowRenderer){let t=c(r.metadataRowRenderer.title).toLowerCase(),n=r.metadataRowRenderer.contents[0];e[t]=c(n);let i=n.runs;i&&i[0].navigationEndpoint&&(e[t+"_url"]=o.resolve(s,i[0].navigationEndpoint.commandMetadata.webCommandMetadata.url)),t in u&&(e.category=u[t].name,e.category_url=u[t].url)}else if(r.richMetadataRowRenderer){let t=r.richMetadataRowRenderer.contents,n=t.filter(t=>"RICH_METADATA_RENDERER_STYLE_BOX_ART"===t.richMetadataRenderer.style);for(let{richMetadataRenderer:t}of n){let r=t;e.year=c(r.subtitle);let n=c(r.callToAction).split(" ")[1];e[n]=c(r.title),e[n+"_url"]=o.resolve(s,r.endpoint.commandMetadata.webCommandMetadata.url),e.thumbnails=r.thumbnail.thumbnails}let i=t.filter(t=>"RICH_METADATA_RENDERER_STYLE_TOPIC"===t.richMetadataRenderer.style);for(let{richMetadataRenderer:t}of i){let r=t;e.category=c(r.title),e.category_url=o.resolve(s,r.endpoint.commandMetadata.webCommandMetadata.url)}}}catch(t){}return e};const l=t=>!(!t||!t.find(t=>"Verified"===t.metadataBadgeRenderer.tooltip));e.getAuthor=t=>{let e,r,i=[],a=!1;try{let u=t.response.contents.twoColumnWatchNextResults.results.results.contents.find(t=>t.videoSecondaryInfoRenderer&&t.videoSecondaryInfoRenderer.owner&&t.videoSecondaryInfoRenderer.owner.videoOwnerRenderer).videoSecondaryInfoRenderer.owner.videoOwnerRenderer;e=u.navigationEndpoint.browseEndpoint.browseId,i=u.thumbnail.thumbnails.map(t=>(t.url=o.resolve(s,t.url),t)),r=n.parseAbbreviatedNumber(c(u.subscriberCountText)),a=l(u.badges)}catch(t){}try{let u=t.player_response.microformat&&t.player_response.microformat.playerMicroformatRenderer,c=u&&u.channelId||e||t.player_response.videoDetails.channelId,l={id:c,name:u?u.ownerChannelName:t.player_response.videoDetails.author,user:u?u.ownerProfileUrl.split("/").slice(-1)[0]:null,channel_url:"https://www.youtube.com/channel/"+c,external_channel_url:u?"https://www.youtube.com/channel/"+u.externalChannelId:"",user_url:u?o.resolve(s,u.ownerProfileUrl):"",thumbnails:i,verified:a,subscriber_count:r};return i.length&&n.deprecate(l,"avatar",l.thumbnails[0].url,"author.avatar","author.thumbnails[0].url"),l}catch(t){return{}}};const p=(t,e)=>{if(t)try{let r=c(t.viewCountText),i=c(t.shortViewCountText),u=e.find(e=>e.id===t.videoId);/^\d/.test(i)||(i=u&&u.short_view_count_text||""),r=(/^\d/.test(r)?r:i).split(" ")[0];let p=t.shortBylineText.runs[0].navigationEndpoint.browseEndpoint,f=p.browseId,d=c(t.shortBylineText),h=(p.canonicalBaseUrl||"").split("/").slice(-1)[0],m={id:t.videoId,title:c(t.title),published:c(t.publishedTimeText),author:{id:f,name:d,user:h,channel_url:"https://www.youtube.com/channel/"+f,user_url:"https://www.youtube.com/user/"+h,thumbnails:t.channelThumbnail.thumbnails.map(t=>(t.url=o.resolve(s,t.url),t)),verified:l(t.ownerBadges),[Symbol.toPrimitive]:()=>(console.warn("`relatedVideo.author` will be removed in a near future release, use `relatedVideo.author.name` instead."),m.author.name)},short_view_count_text:i.split(" ")[0],view_count:r.replace(/,/g,""),length_seconds:t.lengthText?Math.floor(a(c(t.lengthText))/1e3):e&&""+e.length_seconds,thumbnails:t.thumbnail.thumbnails,richThumbnails:t.richThumbnail?t.richThumbnail.movingThumbnailRenderer.movingThumbnailDetails.thumbnails:[],isLive:!(!t.badges||!t.badges.find(t=>"LIVE NOW"===t.metadataBadgeRenderer.label))};return n.deprecate(m,"author_thumbnail",m.author.thumbnails[0].url,"relatedVideo.author_thumbnail","relatedVideo.author.thumbnails[0].url"),n.deprecate(m,"ucid",m.author.id,"relatedVideo.ucid","relatedVideo.author.id"),n.deprecate(m,"video_thumbnail",m.thumbnails[0].url,"relatedVideo.video_thumbnail","relatedVideo.thumbnails[0].url"),m}catch(t){}};e.getRelatedVideos=t=>{let e=[],r=[];try{e=t.response.webWatchNextResponseExtensionData.relatedVideoArgs.split(",").map(t=>i.parse(t))}catch(t){}try{r=t.response.contents.twoColumnWatchNextResults.secondaryResults.secondaryResults.results}catch(t){return[]}let n=[];for(let t of r||[]){let r=t.compactVideoRenderer;if(r){let t=p(r,e);t&&n.push(t)}else{let r=t.compactAutoplayRenderer||t.itemSectionRenderer;if(!r||!Array.isArray(r.contents))continue;for(let t of r.contents){let r=p(t.compactVideoRenderer,e);r&&n.push(r)}}}return n},e.getLikes=t=>{try{let e=t.response.contents.twoColumnWatchNextResults.results.results.contents.find(t=>t.videoPrimaryInfoRenderer).videoPrimaryInfoRenderer.videoActions.menuRenderer.topLevelButtons.find(t=>t.toggleButtonRenderer&&"LIKE"===t.toggleButtonRenderer.defaultIcon.iconType);return parseInt(e.toggleButtonRenderer.defaultText.accessibility.accessibilityData.label.replace(/\D+/g,""))}catch(t){return null}},e.getDislikes=t=>{try{let e=t.response.contents.twoColumnWatchNextResults.results.results.contents.find(t=>t.videoPrimaryInfoRenderer).videoPrimaryInfoRenderer.videoActions.menuRenderer.topLevelButtons.find(t=>t.toggleButtonRenderer&&"DISLIKE"===t.toggleButtonRenderer.defaultIcon.iconType);return parseInt(e.toggleButtonRenderer.defaultText.accessibility.accessibilityData.label.replace(/\D+/g,""))}catch(t){return null}},e.cleanVideoDetails=t=>(t.thumbnails=t.thumbnail.thumbnails,delete t.thumbnail,n.deprecate(t,"thumbnail",{thumbnails:t.thumbnails},"videoDetails.thumbnail.thumbnails","videoDetails.thumbnails"),t.description=t.shortDescription||c(t.description),delete t.shortDescription,n.deprecate(t,"shortDescription",t.description,"videoDetails.shortDescription","videoDetails.description"),t),e.getStoryboards=t=>{const e=t.player_response.storyboards&&t.player_response.storyboards.playerStoryboardSpecRenderer&&t.player_response.storyboards.playerStoryboardSpecRenderer.spec&&t.player_response.storyboards.playerStoryboardSpecRenderer.spec.split("|");if(!e)return[];const r=new URL(e.shift());return e.map((t,e)=>{let[n,i,o,a,s,u,c,l]=t.split("#");r.searchParams.set("sigh",l),o=parseInt(o,10),a=parseInt(a,10),s=parseInt(s,10);const p=Math.ceil(o/(a*s));return{templateUrl:r.toString().replace("$L",e).replace("$N",c),thumbnailWidth:parseInt(n,10),thumbnailHeight:parseInt(i,10),thumbnailCount:o,interval:parseInt(u,10),columns:a,rows:s,storyboardCount:p}})}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(4);class i extends n.Writable{constructor(){super(),this._lastLine="",this._seq=0,this._nextItemDuration=null,this._nextItemRange=null,this._lastItemRangeEnd=0,this.on("finish",()=>{this._parseLine(this._lastLine),this.emit("end")})}_parseAttrList(t){let e,r={},n=/([A-Z0-9-]+)=(?:"([^"]*?)"|([^,]*?))/g;for(;null!=(e=n.exec(t));)r[e[1]]=e[2]||e[3];return r}_parseRange(t){if(!t)return null;let e=t.split("@"),r=e[1]?parseInt(e[1]):this._lastItemRangeEnd+1,n={start:r,end:r+parseInt(e[0])-1};return this._lastItemRangeEnd=n.end,n}_parseLine(t){let e=t.match(/^#(EXT[A-Z0-9-]+)(?::(.*))?/);if(e){const t=e[1],r=e[2]||"";switch(t){case"EXT-X-PROGRAM-DATE-TIME":this.emit("starttime",new Date(r).getTime());break;case"EXT-X-MEDIA-SEQUENCE":this._seq=parseInt(r);break;case"EXT-X-MAP":{let t=this._parseAttrList(r);if(!t.URI)return void this.destroy(new Error("`EXT-X-MAP` found without required attribute `URI`"));this.emit("item",{url:t.URI,seq:this._seq,init:!0,duration:0,range:this._parseRange(t.BYTERANGE)});break}case"EXT-X-BYTERANGE":this._nextItemRange=this._parseRange(r);break;case"EXTINF":this._nextItemDuration=Math.round(1e3*parseFloat(r.split(",")[0]));break;case"EXT-X-ENDLIST":this.emit("endlist")}}else!/^#/.test(t)&&t.trim()&&(this.emit("item",{url:t.trim(),seq:this._seq++,duration:this._nextItemDuration,range:this._nextItemRange}),this._nextItemRange=null)}_write(t,e,r){let n=t.toString("utf8").split("\n");this._lastLine&&(n[0]=this._lastLine+n[0]),n.forEach((t,e)=>{this.destroyed||(e<n.length-1?this._parseLine(t):this._lastLine=t)}),r()}}e.default=i},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=r(4),o=n(r(12)),a=r(16);class s extends i.Writable{constructor(t){let e;super(),this._parser=o.default.createStream(!1,{lowercase:!0}),this._parser.on("error",this.destroy.bind(this));let r,n,i,s,u,c,l,p,f=0,d=0,h=[],m=!1,g=!1;const y=e=>{const r={RepresentationID:t,Number:d,Time:f};return e.replace(/\$(\w+)\$/g,(t,e)=>r[e]+"")};this._parser.on("opentag",o=>{switch(o.name){case"mpd":f=o.attributes.availabilitystarttime?new Date(o.attributes.availabilitystarttime).getTime():0,c="dynamic"!==o.attributes.type;break;case"period":d=0,n=1e3,s=0,i=0,u=[],l=0,p=a.durationStr(o.attributes.start)||0;break;case"segmentlist":d=parseInt(o.attributes.startnumber)||d,n=parseInt(o.attributes.timescale)||n,s=parseInt(o.attributes.duration)||s,i=parseInt(o.attributes.presentationtimeoffset)||i;break;case"segmenttemplate":r=o.attributes,d=parseInt(o.attributes.startnumber)||d,n=parseInt(o.attributes.timescale)||n;break;case"segmenttimeline":case"baseurl":e=o.name;break;case"s":h.push({duration:parseInt(o.attributes.d),repeat:parseInt(o.attributes.r),time:parseInt(o.attributes.t)});break;case"adaptationset":case"representation":l++,null==t&&(t=o.attributes.id),m=o.attributes.id===t+"",m&&(p&&(f+=p),i&&(f-=i/n*1e3),this.emit("starttime",f));break;case"initialization":m&&this.emit("item",{url:u.filter(t=>!!t).join("")+o.attributes.sourceurl,seq:d,init:!0,duration:0});break;case"segmenturl":if(m){g=!0;let t=h.shift(),e=(t&&t.duration||s)/n*1e3;this.emit("item",{url:u.filter(t=>!!t).join("")+o.attributes.media,seq:d++,duration:e}),f+=e}}});const b=()=>{c&&this.emit("endlist"),m?this.emit("end"):this.destroy(Error(`Representation '${t}' not found`))};this._parser.on("closetag",t=>{switch(t){case"adaptationset":case"representation":if(l--,r&&h.length){g=!0,r.initialization&&this.emit("item",{url:u.filter(t=>!!t).join("")+y(r.initialization),seq:d,init:!0,duration:0});for(let{duration:t,repeat:e,time:i}of h){t=t/n*1e3,e=e||1,f=i||f;for(let n=0;n<e;n++)this.emit("item",{url:u.filter(t=>!!t).join("")+y(r.media),seq:d++,duration:t}),f+=t}}g&&(this.emit("endearly"),b(),this._parser.removeAllListeners(),this.removeAllListeners("finish"))}}),this._parser.on("text",t=>{"baseurl"===e&&(u[l]=t,e=null)}),this.on("finish",b)}_write(t,e,r){this._parser.write(t,e),r()}}e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t,e={}){this._worker=t,this._concurrency=e.concurrency||1,this.tasks=[],this.total=0,this.active=0}push(t,e){this.tasks.push({item:t,callback:e}),this.total++,this._next()}_next(){if(this.active>=this._concurrency||!this.tasks.length)return;const{item:t,callback:e}=this.tasks.shift();let r=!1;this.active++,this._worker(t,(t,n)=>{r||(this.active--,r=!0,e&&e(t,n),this._next())})}die(){this.tasks=[]}}},function(t,e,r){const n=r(0),i=r(19),o=r(6),a=r(35),s=r(5),u=["www.youtube.com","youtube.com","music.youtube.com"],c="https://www.youtube.com/playlist?",l=t.exports=async(t,e,r=3)=>{if(0===r)throw new Error("Unable to find JSON!");const u=await l.getPlaylistID(t),f=i.checkArgs(u,e),d=c+o.encode(f.query),h=await s(d,f.requestOptions).text(),m=i.parseBody(h,f);if(!m.json)return l(t,f,r-1);if(m.json.alerts&&!m.json.contents){let t=m.json.alerts.find(t=>t.alertRenderer&&"ERROR"===t.alertRenderer.type);if(t)throw new Error("API-Error: "+i.parseText(t.alertRenderer.text))}const g=m.json.sidebar.playlistSidebarRenderer.items.find(t=>"playlistSidebarPrimaryInfoRenderer"===Object.keys(t)[0]).playlistSidebarPrimaryInfoRenderer,y=m.json.sidebar.playlistSidebarRenderer.items.find(t=>"playlistSidebarSecondaryInfoRenderer"===Object.keys(t)[0]),b=y?y.playlistSidebarSecondaryInfoRenderer.videoOwner.videoOwnerRenderer:null,v=(g.thumbnailRenderer.playlistVideoThumbnailRenderer||g.thumbnailRenderer.playlistCustomThumbnailRenderer).thumbnail.thumbnails.sort((t,e)=>e.width-t.width),w={id:u,url:`${c}list=${u}`,title:i.parseText(g.title),estimatedItemCount:i.parseIntegerFromText(g.stats[0]),views:3===g.stats.length?i.parseIntegerFromText(g.stats[1]):0,thumbnails:v,bestThumbnail:v[0],lastUpdated:i.parseText(g.stats[2]),description:Array.isArray(g.description)&&g.description.length?i.parseText(g.description):null,visibility:g.badges&&JSON.stringify(g.badges).includes("UNLISTED")?"unlisted":"everyone",author:y?{name:b.title.runs[0].text,url:n.resolve(c,b.navigationEndpoint.commandMetadata.webCommandMetadata.url),avatars:b.thumbnail.thumbnails.sort((t,e)=>e.width-t.width),bestAvatar:b.thumbnail.thumbnails.sort((t,e)=>e.width-t.width)[0],channelID:b.navigationEndpoint.browseEndpoint.browseId}:null,items:[],continuation:null},_=m.json.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content.sectionListRenderer.contents[0].itemSectionRenderer.contents[0].playlistVideoListRenderer.contents;w.items=_.map(a).filter(t=>t).filter((t,e)=>e<f.limit),f.limit-=w.items.length,f.pages-=1;const E=_.find(t=>"continuationItemRenderer"===Object.keys(t)[0]);let T=null;if(E&&(T=E.continuationItemRenderer.continuationEndpoint.continuationCommand.token),T&&f.limit===1/0&&(w.continuation=[m.apiKey,T,m.context,f]),!T||f.limit<1||f.pages<1)return w;const I=await p(m.apiKey,T,m.context,f);return w.items.push(...I.items),w.continuation=I.continuation,w};l.version=r(20).version;const p=async(t,e,r,n)=>{const o=(await i.doPost("https://www.youtube.com/youtubei/v1/browse?key="+t,{context:r,continuation:e},n.requestOptions)).onResponseReceivedActions[0].appendContinuationItemsAction.continuationItems,s=o.map(a).filter(t=>t).filter((t,e)=>e<n.limit);n.limit-=s.length,n.pages-=1;const u=o.find(t=>"continuationItemRenderer"===Object.keys(t)[0]);let c=null;if(u&&(c=u.continuationItemRenderer.continuationEndpoint.continuationCommand.token),!c||n.limit<1||n.pages<1)return{continuation:c&&n.limit===1/0?[t,c,r,n]:null,items:s};const l=await p(t,c,r,n);return l.items.unshift(...s),l};l.continueReq=async t=>{if(!Array.isArray(t)||4!==t.length)throw new Error("invalid continuation array");if(!t[0]||"string"!=typeof t[0])throw new Error("invalid apiKey");if(!t[1]||"string"!=typeof t[1])throw new Error("invalid token");if(!t[2]||"object"!=typeof t[2])throw new Error("invalid context");if(!t[3]||"object"!=typeof t[3])throw new Error("invalid opts");if(!isNaN(t[3].limit)&&isFinite(t[3].limit))throw new Error("continueReq only allowed for paged requests");return t[3].pages=1,t[3].limit=1/0,p(...t)},l.validateID=t=>{if("string"!=typeof t||!t)return!1;if(f.test(t)||d.test(t))return!0;if(h.test(t))return!0;const e=n.parse(t,!0);if(!u.includes(e.host))return!1;if(Object.prototype.hasOwnProperty.call(e.query,"list"))return!(!f.test(e.query.list)&&!d.test(e.query.list));const r=e.pathname.substr(1).split("/");if(r.length<2||r.some(t=>!t))return!1;const i=r[r.length-2],o=r[r.length-1];if("channel"===i){if(h.test(o))return!0}else{if("user"===i)return!0;if("c"===i)return!0}return!1};const f=e.PLAYLIST_REGEX=/^(FL|PL|UU|LL|RD)[a-zA-Z0-9-_]{16,41}$/,d=e.ALBUM_REGEX=/^OLAK5uy_[a-zA-Z0-9-_]{33}$/,h=e.CHANNEL_REGEX=/^UC[a-zA-Z0-9-_]{22,32}$/;l.getPlaylistID=async t=>{if("string"!=typeof t||!t)throw new Error("The linkOrId has to be a string");if(f.test(t)||d.test(t))return t;if(h.test(t))return"UU"+t.substr(2);const e=n.parse(t,!0);if(!u.includes(e.host))throw new Error("not a known youtube link");if(Object.prototype.hasOwnProperty.call(e.query,"list")){if(f.test(e.query.list)||d.test(e.query.list))return e.query.list;if(e.query.list&&e.query.list.startsWith("RD")&&e.query.list.length<18)throw new Error("Mixes not supported");throw new Error("invalid or unknown list query in url")}const r=e.pathname.substr(1).split("/");if(r.length<2||r.some(t=>!t))throw new Error(`Unable to find a id in "${t}"`);const i=r[r.length-2],o=r[r.length-1];if("channel"===i){if(h.test(o))return"UU"+o.substr(2)}else{if("user"===i)return await g("https://www.youtube.com/user/"+o);if("c"===i)return await g("https://www.youtube.com/c/"+o)}throw new Error(`Unable to find a id in "${t}"`)};const m=/channel_id=UC([\w-]{22,32})"/,g=async t=>{const e=(await s(t).text()).match(m);if(e)return"UU"+e[1];throw new Error("unable to resolve the ref: "+t)}},function(t,e,r){const n=r(2),i=r(3),o=r(0),a=r(19),s=["continuationItemRenderer"],u="https://www.youtube.com/watch?v=",c=a.prepImg,l=t=>{const e=Object.keys(t)[0];if(s.includes(e))return null;if("playlistVideoRenderer"!==e)throw new Error(`unexpected type "${e}"`);let r=t[e];if(!r||!r.shortBylineText||r.upcomingEventData)return null;const n=r.thumbnailOverlays.some(t=>t.thumbnailOverlayTimeStatusRenderer&&"LIVE"===t.thumbnailOverlayTimeStatusRenderer.style),i=r.shortBylineText.runs[0];return{title:a.parseText(r.title),index:r.index?a.parseIntegerFromText(r.index):-1,id:r.videoId,shortUrl:u+r.videoId,url:o.resolve(u,r.navigationEndpoint.commandMetadata.webCommandMetadata.url),author:{url:o.resolve(u,i.navigationEndpoint.commandMetadata.webCommandMetadata.url),channelID:i.navigationEndpoint.browseEndpoint.browseId,name:i.text},thumbnails:c(r.thumbnail.thumbnails),bestThumbnail:c(r.thumbnail.thumbnails)[0],isLive:n,duration:r.lengthText?a.parseText(r.lengthText):null,durationSec:Number(r.lengthSeconds)||null,isPlayable:r.isPlayable}},p=(t,e=[])=>{if(!Array.isArray(e))throw new Error("params has to be an (optionally empty) array");try{return t(...e)}catch(o){const a=n.resolve(__dirname,"../dumps/"),s=n.resolve(a,`${Math.random().toString(36).substr(3)}-${Date.now()}.txt`),u=n.resolve(__dirname,"../package.json"),c=r(36)(u).bugs.url;i.existsSync(a)||i.mkdirSync(a),i.writeFileSync(s,JSON.stringify(e,null,2)),console.error(o.stack),console.error("\n/"+"*".repeat(200)),console.error(`failed at func ${t.name}: ${o.message}`),console.error(`pls post the the files in ${a} to ${c}`);let l=`os: ${process.platform}-${process.arch}, `;return l+=`node.js: ${process.version}, `,l+="ytpl: "+r(20).version,console.error(l),console.error("*".repeat(200)+"\\"),null}};(t.exports=(...t)=>p(l,t))._hidden={catchAndLogFunc:p}},function(t,e){function r(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}r.keys=function(){return[]},r.resolve=r,t.exports=r,r.id=36},function(t,e,r){var n=r(21),i=r(2),o=n.platform();"darwin"==o?o="mac":"win32"==o&&(o="win"),"linux"!==o&&"mac"!==o&&"win"!==o&&"browser"!==o&&(console.error("Unsupported platform.",o),process.exit(1));var a=n.arch();"mac"===o&&"x64"!==a&&(console.error("Unsupported architecture."),process.exit(1));var s=i.join(__dirname,"bin",o,a,"win"===o?"ffmpeg.exe":"ffmpeg");e.path=s},function(t,e,r){"use strict";var n=r(2),i=r(39),o=r(40).EventEmitter,a=r(1);function s(t,e){if(!(this instanceof s))return new s(t,e);o.call(this),"object"!=typeof t||"readable"in t?(e=e||{}).source=t:e=t,this._inputs=[],e.source&&this.input(e.source),this._outputs=[],this.output();var r=this;["_global","_complexFilters"].forEach((function(t){r[t]=a.args()})),e.stdoutLines="stdoutLines"in e?e.stdoutLines:100,e.presets=e.presets||e.preset||n.join(__dirname,"presets"),e.niceness=e.niceness||e.priority||0,this.options=e,this.logger=e.logger||{debug:function(){},info:function(){},warn:function(){},error:function(){}}}i.inherits(s,o),t.exports=s,s.prototype.clone=function(){var t=new s,e=this;return t.options=this.options,t.logger=this.logger,t._inputs=this._inputs.map((function(t){return{source:t.source,options:t.options.clone()}})),"target"in this._outputs[0]?(t._outputs=[],t.output()):(t._outputs=[t._currentOutput={flags:{}}],["audio","audioFilters","video","videoFilters","sizeFilters","options"].forEach((function(r){t._currentOutput[r]=e._currentOutput[r].clone()})),this._currentOutput.sizeData&&(t._currentOutput.sizeData={},a.copy(this._currentOutput.sizeData,t._currentOutput.sizeData)),a.copy(this._currentOutput.flags,t._currentOutput.flags)),["_global","_complexFilters"].forEach((function(r){t[r]=e[r].clone()})),t},r(45)(s.prototype),r(46)(s.prototype),r(47)(s.prototype),r(48)(s.prototype),r(49)(s.prototype),r(50)(s.prototype),r(51)(s.prototype),r(53)(s.prototype),r(55)(s.prototype),s.setFfmpegPath=function(t){(new s).setFfmpegPath(t)},s.setFfprobePath=function(t){(new s).setFfprobePath(t)},s.setFlvtoolPath=function(t){(new s).setFlvtoolPath(t)},s.availableFilters=s.getAvailableFilters=function(t){(new s).availableFilters(t)},s.availableCodecs=s.getAvailableCodecs=function(t){(new s).availableCodecs(t)},s.availableFormats=s.getAvailableFormats=function(t){(new s).availableFormats(t)},s.availableEncoders=s.getAvailableEncoders=function(t){(new s).availableEncoders(t)},r(56)(s.prototype),s.ffprobe=function(t){var e=new s(t);e.ffprobe.apply(e,Array.prototype.slice.call(arguments,1))},r(57)(s.prototype)},function(t,e){t.exports=require("util")},function(t,e){t.exports=require("events")},function(t,e,r){t.exports=c,c.sync=function(t,e){for(var r=u(t,e=e||{}),n=r.env,o=r.ext,c=r.extExe,l=[],p=0,f=n.length;p<f;p++){var d=n[p];'"'===d.charAt(0)&&'"'===d.slice(-1)&&(d=d.slice(1,-1));var h=i.join(d,t);!d&&/^\.[\\\/]/.test(t)&&(h=t.slice(0,2)+h);for(var m=0,g=o.length;m<g;m++){var y=h+o[m];try{if(a.sync(y,{pathExt:c})){if(!e.all)return y;l.push(y)}}catch(t){}}}if(e.all&&l.length)return l;if(e.nothrow)return null;throw s(t)};var n="win32"===process.platform||"cygwin"===process.env.OSTYPE||"msys"===process.env.OSTYPE,i=r(2),o=n?";":":",a=r(42);function s(t){var e=new Error("not found: "+t);return e.code="ENOENT",e}function u(t,e){var r=e.colon||o,i=e.path||process.env.PATH||"",a=[""];i=i.split(r);var s="";return n&&(i.unshift(process.cwd()),a=(s=e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM").split(r),-1!==t.indexOf(".")&&""!==a[0]&&a.unshift("")),(t.match(/\//)||n&&t.match(/\\/))&&(i=[""]),{env:i,ext:a,extExe:s}}function c(t,e,r){"function"==typeof e&&(r=e,e={});var n=u(t,e),o=n.env,c=n.ext,l=n.extExe,p=[];!function n(u,f){if(u===f)return e.all&&p.length?r(null,p):r(s(t));var d=o[u];'"'===d.charAt(0)&&'"'===d.slice(-1)&&(d=d.slice(1,-1));var h=i.join(d,t);!d&&/^\.[\\\/]/.test(t)&&(h=t.slice(0,2)+h),function t(i,o){if(i===o)return n(u+1,f);var s=c[i];a(h+s,{pathExt:l},(function(n,a){if(!n&&a){if(!e.all)return r(null,h+s);p.push(h+s)}return t(i+1,o)}))}(0,c.length)}(0,o.length)}},function(t,e,r){var n;r(3);function i(t,e,r){if("function"==typeof e&&(r=e,e={}),!r){if("function"!=typeof Promise)throw new TypeError("callback not provided");return new Promise((function(r,n){i(t,e||{},(function(t,e){t?n(t):r(e)}))}))}n(t,e||{},(function(t,n){t&&("EACCES"===t.code||e&&e.ignoreErrors)&&(t=null,n=!1),r(t,n)}))}n="win32"===process.platform||global.TESTING_WINDOWS?r(43):r(44),t.exports=i,i.sync=function(t,e){try{return n.sync(t,e||{})}catch(t){if(e&&e.ignoreErrors||"EACCES"===t.code)return!1;throw t}}},function(t,e,r){t.exports=o,o.sync=function(t,e){return i(n.statSync(t),t,e)};var n=r(3);function i(t,e,r){return!(!t.isSymbolicLink()&&!t.isFile())&&function(t,e){var r=void 0!==e.pathExt?e.pathExt:process.env.PATHEXT;if(!r)return!0;if(-1!==(r=r.split(";")).indexOf(""))return!0;for(var n=0;n<r.length;n++){var i=r[n].toLowerCase();if(i&&t.substr(-i.length).toLowerCase()===i)return!0}return!1}(e,r)}function o(t,e,r){n.stat(t,(function(n,o){r(n,!n&&i(o,t,e))}))}},function(t,e,r){t.exports=i,i.sync=function(t,e){return o(n.statSync(t),e)};var n=r(3);function i(t,e,r){n.stat(t,(function(t,n){r(t,!t&&o(n,e))}))}function o(t,e){return t.isFile()&&function(t,e){var r=t.mode,n=t.uid,i=t.gid,o=void 0!==e.uid?e.uid:process.getuid&&process.getuid(),a=void 0!==e.gid?e.gid:process.getgid&&process.getgid(),s=parseInt("100",8),u=parseInt("010",8),c=parseInt("001",8),l=s|u;return r&c||r&u&&i===a||r&s&&n===o||r&l&&0===o}(t,e)}},function(t,e,r){"use strict";var n=r(1);t.exports=function(t){t.mergeAdd=t.addInput=t.input=function(t){var e=!1,r=!1;if("string"!=typeof t){if(!("readable"in t)||!t.readable)throw new Error("Invalid input");if(this._inputs.some((function(t){return t.isStream})))throw new Error("Only one input stream is supported");r=!0,t.pause()}else{var i=t.match(/^([a-z]{2,}):/i);e=!i||"file"===i[0]}return this._inputs.push(this._currentInput={source:t,isFile:e,isStream:r,options:n.args()}),this},t.withInputFormat=t.inputFormat=t.fromFormat=function(t){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-f",t),this},t.withInputFps=t.withInputFPS=t.withFpsInput=t.withFPSInput=t.inputFPS=t.inputFps=t.fpsInput=t.FPSInput=function(t){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-r",t),this},t.nativeFramerate=t.withNativeFramerate=t.native=function(){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-re"),this},t.setStartTime=t.seekInput=function(t){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-ss",t),this},t.loop=function(t){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-loop","1"),void 0!==t&&this.duration(t),this}}},function(t,e,r){"use strict";var n=r(1);t.exports=function(t){t.withNoAudio=t.noAudio=function(){return this._currentOutput.audio.clear(),this._currentOutput.audioFilters.clear(),this._currentOutput.audio("-an"),this},t.withAudioCodec=t.audioCodec=function(t){return this._currentOutput.audio("-acodec",t),this},t.withAudioBitrate=t.audioBitrate=function(t){return this._currentOutput.audio("-b:a",(""+t).replace(/k?$/,"k")),this},t.withAudioChannels=t.audioChannels=function(t){return this._currentOutput.audio("-ac",t),this},t.withAudioFrequency=t.audioFrequency=function(t){return this._currentOutput.audio("-ar",t),this},t.withAudioQuality=t.audioQuality=function(t){return this._currentOutput.audio("-aq",t),this},t.withAudioFilter=t.withAudioFilters=t.audioFilter=t.audioFilters=function(t){return arguments.length>1&&(t=[].slice.call(arguments)),Array.isArray(t)||(t=[t]),this._currentOutput.audioFilters(n.makeFilterStrings(t)),this}}},function(t,e,r){"use strict";var n=r(1);t.exports=function(t){t.withNoVideo=t.noVideo=function(){return this._currentOutput.video.clear(),this._currentOutput.videoFilters.clear(),this._currentOutput.video("-vn"),this},t.withVideoCodec=t.videoCodec=function(t){return this._currentOutput.video("-vcodec",t),this},t.withVideoBitrate=t.videoBitrate=function(t,e){return t=(""+t).replace(/k?$/,"k"),this._currentOutput.video("-b:v",t),e&&this._currentOutput.video("-maxrate",t,"-minrate",t,"-bufsize","3M"),this},t.withVideoFilter=t.withVideoFilters=t.videoFilter=t.videoFilters=function(t){return arguments.length>1&&(t=[].slice.call(arguments)),Array.isArray(t)||(t=[t]),this._currentOutput.videoFilters(n.makeFilterStrings(t)),this},t.withOutputFps=t.withOutputFPS=t.withFpsOutput=t.withFPSOutput=t.withFps=t.withFPS=t.outputFPS=t.outputFps=t.fpsOutput=t.FPSOutput=t.fps=t.FPS=function(t){return this._currentOutput.video("-r",t),this},t.takeFrames=t.withFrames=t.frames=function(t){return this._currentOutput.video("-vframes",t),this}}},function(t,e,r){"use strict";function n(t,e,r,n){return[{filter:"scale",options:{w:"if(gt(a,"+r+"),"+t+",trunc("+e+"*a/2)*2)",h:"if(lt(a,"+r+"),"+e+",trunc("+t+"/a/2)*2)"}},{filter:"pad",options:{w:t,h:e,x:"if(gt(a,"+r+"),0,("+t+"-iw)/2)",y:"if(lt(a,"+r+"),0,("+e+"-ih)/2)",color:n}}]}function i(t,e,r){var i=t.sizeData=t.sizeData||{};if(i[e]=r,!("size"in i))return[];var o,a,s,u=i.size.match(/([0-9]+)x([0-9]+)/),c=i.size.match(/([0-9]+)x\?/),l=i.size.match(/\?x([0-9]+)/),p=i.size.match(/\b([0-9]{1,3})%/);if(p){var f=Number(p[1])/100;return[{filter:"scale",options:{w:"trunc(iw*"+f+"/2)*2",h:"trunc(ih*"+f+"/2)*2"}}]}if(u)return s=(o=2*Math.round(Number(u[1])/2))/(a=2*Math.round(Number(u[2])/2)),i.pad?n(o,a,s,i.pad):[{filter:"scale",options:{w:o,h:a}}];if(c||l)return"aspect"in i?(o=c?c[1]:Math.round(Number(l[1])*i.aspect),a=l?l[1]:Math.round(Number(c[1])/i.aspect),o=2*Math.round(o/2),a=2*Math.round(a/2),i.pad?n(o,a,i.aspect,i.pad):[{filter:"scale",options:{w:o,h:a}}]):c?[{filter:"scale",options:{w:2*Math.round(Number(c[1])/2),h:"trunc(ow/a/2)*2"}}]:[{filter:"scale",options:{w:"trunc(oh*a/2)*2",h:2*Math.round(Number(l[1])/2)}}];throw new Error("Invalid size specified: "+i.size)}t.exports=function(t){t.keepPixelAspect=t.keepDisplayAspect=t.keepDisplayAspectRatio=t.keepDAR=function(){return this.videoFilters([{filter:"scale",options:{w:"if(gt(sar,1),iw*sar,iw)",h:"if(lt(sar,1),ih/sar,ih)"}},{filter:"setsar",options:"1"}])},t.withSize=t.setSize=t.size=function(t){var e=i(this._currentOutput,"size",t);return this._currentOutput.sizeFilters.clear(),this._currentOutput.sizeFilters(e),this},t.withAspect=t.withAspectRatio=t.setAspect=t.setAspectRatio=t.aspect=t.aspectRatio=function(t){var e=Number(t);if(isNaN(e)){var r=t.match(/^(\d+):(\d+)$/);if(!r)throw new Error("Invalid aspect ratio: "+t);e=Number(r[1])/Number(r[2])}var n=i(this._currentOutput,"aspect",e);return this._currentOutput.sizeFilters.clear(),this._currentOutput.sizeFilters(n),this},t.applyAutopadding=t.applyAutoPadding=t.applyAutopad=t.applyAutoPad=t.withAutopadding=t.withAutoPadding=t.withAutopad=t.withAutoPad=t.autoPad=t.autopad=function(t,e){"string"==typeof t&&(e=t,t=!0),void 0===t&&(t=!0);var r=i(this._currentOutput,"pad",!!t&&(e||"black"));return this._currentOutput.sizeFilters.clear(),this._currentOutput.sizeFilters(r),this}}},function(t,e,r){"use strict";var n=r(1);t.exports=function(t){t.addOutput=t.output=function(t,e){var r=!1;if(!t&&this._currentOutput)throw new Error("Invalid output");if(t&&"string"!=typeof t){if(!("writable"in t)||!t.writable)throw new Error("Invalid output")}else if("string"==typeof t){var i=t.match(/^([a-z]{2,}):/i);r=!i||"file"===i[0]}if(t&&!("target"in this._currentOutput))this._currentOutput.target=t,this._currentOutput.isFile=r,this._currentOutput.pipeopts=e||{};else{if(t&&"string"!=typeof t)if(this._outputs.some((function(t){return"string"!=typeof t.target})))throw new Error("Only one output stream is supported");this._outputs.push(this._currentOutput={target:t,isFile:r,flags:{},pipeopts:e||{}});var o=this;["audio","audioFilters","video","videoFilters","sizeFilters","options"].forEach((function(t){o._currentOutput[t]=n.args()})),t||delete this._currentOutput.target}return this},t.seekOutput=t.seek=function(t){return this._currentOutput.options("-ss",t),this},t.withDuration=t.setDuration=t.duration=function(t){return this._currentOutput.options("-t",t),this},t.toFormat=t.withOutputFormat=t.outputFormat=t.format=function(t){return this._currentOutput.options("-f",t),this},t.map=function(t){return this._currentOutput.options("-map",t.replace(n.streamRegexp,"[$1]")),this},t.updateFlvMetadata=t.flvmeta=function(){return this._currentOutput.flags.flvmeta=!0,this}}},function(t,e,r){"use strict";var n=r(1);t.exports=function(t){t.addInputOption=t.addInputOptions=t.withInputOption=t.withInputOptions=t.inputOption=t.inputOptions=function(t){if(!this._currentInput)throw new Error("No input specified");var e=!0;return arguments.length>1&&(t=[].slice.call(arguments),e=!1),Array.isArray(t)||(t=[t]),this._currentInput.options(t.reduce((function(t,r){var n=String(r).split(" ");return e&&2===n.length?t.push(n[0],n[1]):t.push(r),t}),[])),this},t.addOutputOption=t.addOutputOptions=t.addOption=t.addOptions=t.withOutputOption=t.withOutputOptions=t.withOption=t.withOptions=t.outputOption=t.outputOptions=function(t){var e=!0;return arguments.length>1&&(t=[].slice.call(arguments),e=!1),Array.isArray(t)||(t=[t]),this._currentOutput.options(t.reduce((function(t,r){var n=String(r).split(" ");return e&&2===n.length?t.push(n[0],n[1]):t.push(r),t}),[])),this},t.filterGraph=t.complexFilter=function(t,e){if(this._complexFilters.clear(),Array.isArray(t)||(t=[t]),this._complexFilters("-filter_complex",n.makeFilterStrings(t).join(";")),Array.isArray(e)){var r=this;e.forEach((function(t){r._complexFilters("-map",t.replace(n.streamRegexp,"[$1]"))}))}else"string"==typeof e&&this._complexFilters("-map",e.replace(n.streamRegexp,"[$1]"));return this}}},function(t,e,r){"use strict";var n=r(2);t.exports=function(t){t.usingPreset=t.preset=function(t){if("function"==typeof t)t(this);else try{var e=n.join(this.options.presets,t),i=r(52)(e);if("function"!=typeof i.load)throw new Error("preset "+e+" has no load() function");i.load(this)}catch(t){throw new Error("preset "+e+" could not be loaded: "+t.message)}return this}}},function(t,e){function r(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}r.keys=function(){return[]},r.resolve=r,t.exports=r,r.id=52},function(t,e,r){"use strict";var n=r(10).spawn,i=(r(2),r(3),r(11)),o=r(1);function a(t){t._inputs[0].isStream||t.ffprobe(0,(function(e,r){t._ffprobeData=r}))}t.exports=function(t){t._spawnFfmpeg=function(t,e,r,i){"function"==typeof e&&(i=r,r=e,e={}),void 0===i&&(i=r,r=function(){});var a="stdoutLines"in e?e.stdoutLines:this.options.stdoutLines;this._getFfmpegPath((function(s,u){if(s)return i(s);if(!u||0===u.length)return i(new Error("Cannot find ffmpeg"));e.niceness&&0!==e.niceness&&!o.isWindows&&(t.unshift("-n",e.niceness,u),u="nice");var c=o.linesRing(a),l=!1,p=o.linesRing(a),f=!1,d=n(u,t,e);d.stderr&&d.stderr.setEncoding("utf8"),d.on("error",(function(t){i(t)}));var h=null;function m(t){t&&(h=t),g&&(l||!e.captureStdout)&&f&&i(h,c,p)}var g=!1;d.on("exit",(function(t,e){g=!0,e?m(new Error("ffmpeg was killed with signal "+e)):t?m(new Error("ffmpeg exited with code "+t)):m()})),e.captureStdout&&(d.stdout.on("data",(function(t){c.append(t)})),d.stdout.on("close",(function(){c.close(),l=!0,m()}))),d.stderr.on("data",(function(t){p.append(t)})),d.stderr.on("close",(function(){p.close(),f=!0,m()})),r(d,c,p)}))},t._getArguments=function(){var t=this._complexFilters.get(),e=this._outputs.some((function(t){return t.isFile}));return[].concat(this._inputs.reduce((function(t,e){var r="string"==typeof e.source?e.source:"pipe:0";return t.concat(e.options.get(),["-i",r])}),[]),this._global.get(),e?["-y"]:[],t,this._outputs.reduce((function(t,e){var r,n=o.makeFilterStrings(e.sizeFilters.get()),i=e.audioFilters.get(),a=e.videoFilters.get().concat(n);return r=e.target?"string"==typeof e.target?[e.target]:["pipe:1"]:[],t.concat(e.audio.get(),i.length?["-filter:a",i.join(",")]:[],e.video.get(),a.length?["-filter:v",a.join(",")]:[],e.options.get(),r)}),[]))},t._prepare=function(t,e){var r=this;i.waterfall([function(t){r._checkCapabilities(t)},function(t){if(!e)return t();r.ffprobe(0,(function(e,n){e||(r._ffprobeData=n),t()}))},function(t){r._outputs.some((function(t){return t.flags.flvmeta&&!t.isFile&&(r.logger.warn("Updating flv metadata is only supported for files"),t.flags.flvmeta=!1),t.flags.flvmeta}))?r._getFlvtoolPath((function(e){t(e)})):t()},function(t){var e;try{e=r._getArguments()}catch(e){return t(e)}t(null,e)},function(t,e){r.availableEncoders((function(r,n){for(var i=0;i<t.length;i++)"-acodec"!==t[i]&&"-vcodec"!==t[i]||(i++,t[i]in n&&n[t[i]].experimental&&(t.splice(i+1,0,"-strict","experimental"),i+=2));e(null,t)}))}],t),e||(this.listeners("progress").length>0?a(this):this.once("newListener",(function(t){"progress"===t&&a(this)})))},t.exec=t.execute=t.run=function(){var t=this;if(!this._outputs.some((function(t){return"target"in t})))throw new Error("No output specified");var e=this._outputs.filter((function(t){return"string"!=typeof t.target}))[0],r=this._inputs.filter((function(t){return"string"!=typeof t.source}))[0],a=!1;function s(e,r,n){a||(a=!0,e?t.emit("error",e,r,n):t.emit("end",r,n))}t._prepare((function(a,u){if(a)return s(a);t._spawnFfmpeg(u,{captureStdout:!e,niceness:t.options.niceness,cwd:t.options.cwd},(function(n,i,a){if(t.ffmpegProc=n,t.emit("start","ffmpeg "+u.join(" ")),r&&(r.source.on("error",(function(t){var e=new Error("Input stream error: "+t.message);e.inputStreamError=t,s(e),n.kill()})),r.source.resume(),r.source.pipe(n.stdin),n.stdin.on("error",(function(){}))),t.options.timeout&&setTimeout((function(){var e="process ran into a timeout ("+t.options.timeout+"s)";s(new Error(e),i.get(),a.get()),n.kill()}),1e3*t.options.timeout),e&&(n.stdout.pipe(e.target,e.pipeopts),e.target.on("close",(function(){t.logger.debug("Output stream closed, scheduling kill for ffmpeg process"),setTimeout((function(){s(new Error("Output stream closed")),n.kill()}),20)})),e.target.on("error",(function(e){t.logger.debug("Output stream error, killing ffmpeg process");var r=new Error("Output stream error: "+e.message);r.outputStreamError=e,s(r,i.get(),a.get()),n.kill("SIGKILL")}))),a){if(t.listeners("stderr").length&&a.callback((function(e){t.emit("stderr",e)})),t.listeners("codecData").length){var c=!1,l={};a.callback((function(e){c||(c=o.extractCodecData(t,e,l))}))}t.listeners("progress").length&&a.callback((function(e){o.extractProgress(t,e)}))}}),(function(e,r,a){if(delete t.ffmpegProc,e)e.message.match(/ffmpeg exited with code/)&&(e.message+=": "+o.extractError(a.get())),s(e,r.get(),a.get());else{var u=t._outputs.filter((function(t){return t.flags.flvmeta}));u.length?t._getFlvtoolPath((function(t,e){if(t)return s(t);i.each(u,(function(t,r){n(e,["-U",t.target]).on("error",(function(n){r(new Error("Error running "+e+" on "+t.target+": "+n.message))})).on("exit",(function(n,i){0!==n||i?r(new Error(e+" "+(i?"received signal "+i:"exited with code "+n))+" when running on "+t.target):r()}))}),(function(t){t?s(t):s(null,r.get(),a.get())}))})):s(null,r.get(),a.get())}}))}))},t.renice=function(t){if(!o.isWindows&&(((t=t||0)<-20||t>20)&&this.logger.warn("Invalid niceness value: "+t+", must be between -20 and 20"),t=Math.min(20,Math.max(-20,t)),this.options.niceness=t,this.ffmpegProc)){var e=this.logger,r=this.ffmpegProc.pid,i=n("renice",[t,"-p",r]);i.on("error",(function(t){e.warn("could not renice process "+r+": "+t.message)})),i.on("exit",(function(n,i){i?e.warn("could not renice process "+r+": renice was killed by signal "+i):n?e.warn("could not renice process "+r+": renice exited with "+n):e.info("successfully reniced process "+r+" to "+t+" niceness")}))}return this},t.kill=function(t){return this.ffmpegProc?this.ffmpegProc.kill(t||"SIGKILL"):this.logger.warn("No running ffmpeg process, cannot send signal"),this}}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,r){"use strict";var n=r(3),i=r(2),o=r(11),a=r(1),s=/^\s*([D ])([E ])([VAS])([S ])([D ])([T ]) ([^ ]+) +(.*)$/,u=/^\s*([D\.])([E\.])([VAS])([I\.])([L\.])([S\.]) ([^ ]+) +(.*)$/,c=/\(encoders:([^\)]+)\)/,l=/\(decoders:([^\)]+)\)/,p=/^\s*([VAS\.])([F\.])([S\.])([X\.])([B\.])([D\.]) ([^ ]+) +(.*)$/,f=/^\s*([D ])([E ]) ([^ ]+) +(.*)$/,d=/\r\n|\r|\n/,h=/^(?: [T\.][S\.][C\.] )?([^ ]+) +(AA?|VV?|\|)->(AA?|VV?|\|) +(.*)$/,m={};t.exports=function(t){t.setFfmpegPath=function(t){return m.ffmpegPath=t,this},t.setFfprobePath=function(t){return m.ffprobePath=t,this},t.setFlvtoolPath=function(t){return m.flvtoolPath=t,this},t._forgetPaths=function(){delete m.ffmpegPath,delete m.ffprobePath,delete m.flvtoolPath},t._getFfmpegPath=function(t){if("ffmpegPath"in m)return t(null,m.ffmpegPath);o.waterfall([function(t){process.env.FFMPEG_PATH?n.exists(process.env.FFMPEG_PATH,(function(e){t(null,e?process.env.FFMPEG_PATH:"")})):t(null,"")},function(t,e){if(t.length)return e(null,t);a.which("ffmpeg",(function(t,r){e(t,r)}))}],(function(e,r){e?t(e):t(null,m.ffmpegPath=r||"")}))},t._getFfprobePath=function(t){var e=this;if("ffprobePath"in m)return t(null,m.ffprobePath);o.waterfall([function(t){process.env.FFPROBE_PATH?n.exists(process.env.FFPROBE_PATH,(function(e){t(null,e?process.env.FFPROBE_PATH:"")})):t(null,"")},function(t,e){if(t.length)return e(null,t);a.which("ffprobe",(function(t,r){e(t,r)}))},function(t,r){if(t.length)return r(null,t);e._getFfmpegPath((function(t,e){if(t)r(t);else if(e.length){var o=a.isWindows?"ffprobe.exe":"ffprobe",s=i.join(i.dirname(e),o);n.exists(s,(function(t){r(null,t?s:"")}))}else r(null,"")}))}],(function(e,r){e?t(e):t(null,m.ffprobePath=r||"")}))},t._getFlvtoolPath=function(t){if("flvtoolPath"in m)return t(null,m.flvtoolPath);o.waterfall([function(t){process.env.FLVMETA_PATH?n.exists(process.env.FLVMETA_PATH,(function(e){t(null,e?process.env.FLVMETA_PATH:"")})):t(null,"")},function(t,e){if(t.length)return e(null,t);process.env.FLVTOOL2_PATH?n.exists(process.env.FLVTOOL2_PATH,(function(t){e(null,t?process.env.FLVTOOL2_PATH:"")})):e(null,"")},function(t,e){if(t.length)return e(null,t);a.which("flvmeta",(function(t,r){e(t,r)}))},function(t,e){if(t.length)return e(null,t);a.which("flvtool2",(function(t,r){e(t,r)}))}],(function(e,r){e?t(e):t(null,m.flvtoolPath=r||"")}))},t.availableFilters=t.getAvailableFilters=function(t){if("filters"in m)return t(null,m.filters);this._spawnFfmpeg(["-filters"],{captureStdout:!0,stdoutLines:0},(function(e,r){if(e)return t(e);var n=r.get().split("\n"),i={},o={A:"audio",V:"video","|":"none"};n.forEach((function(t){var e=t.match(h);e&&(i[e[1]]={description:e[4],input:o[e[2].charAt(0)],multipleInputs:e[2].length>1,output:o[e[3].charAt(0)],multipleOutputs:e[3].length>1})})),t(null,m.filters=i)}))},t.availableCodecs=t.getAvailableCodecs=function(t){if("codecs"in m)return t(null,m.codecs);this._spawnFfmpeg(["-codecs"],{captureStdout:!0,stdoutLines:0},(function(e,r){if(e)return t(e);var n=r.get().split(d),i={};n.forEach((function(t){var e=t.match(s);if(e&&"="!==e[7]&&(i[e[7]]={type:{V:"video",A:"audio",S:"subtitle"}[e[3]],description:e[8],canDecode:"D"===e[1],canEncode:"E"===e[2],drawHorizBand:"S"===e[4],directRendering:"D"===e[5],weirdFrameTruncation:"T"===e[6]}),(e=t.match(u))&&"="!==e[7]){var r=i[e[7]]={type:{V:"video",A:"audio",S:"subtitle"}[e[3]],description:e[8],canDecode:"D"===e[1],canEncode:"E"===e[2],intraFrameOnly:"I"===e[4],isLossy:"L"===e[5],isLossless:"S"===e[6]},n=r.description.match(c);n=n?n[1].trim().split(" "):[];var o=r.description.match(l);if(o=o?o[1].trim().split(" "):[],n.length||o.length){var p={};a.copy(r,p),delete p.canEncode,delete p.canDecode,n.forEach((function(t){i[t]={},a.copy(p,i[t]),i[t].canEncode=!0})),o.forEach((function(t){t in i||(i[t]={},a.copy(p,i[t])),i[t].canDecode=!0}))}}})),t(null,m.codecs=i)}))},t.availableEncoders=t.getAvailableEncoders=function(t){if("encoders"in m)return t(null,m.encoders);this._spawnFfmpeg(["-encoders"],{captureStdout:!0,stdoutLines:0},(function(e,r){if(e)return t(e);var n=r.get().split(d),i={};n.forEach((function(t){var e=t.match(p);e&&"="!==e[7]&&(i[e[7]]={type:{V:"video",A:"audio",S:"subtitle"}[e[1]],description:e[8],frameMT:"F"===e[2],sliceMT:"S"===e[3],experimental:"X"===e[4],drawHorizBand:"B"===e[5],directRendering:"D"===e[6]})})),t(null,m.encoders=i)}))},t.availableFormats=t.getAvailableFormats=function(t){if("formats"in m)return t(null,m.formats);this._spawnFfmpeg(["-formats"],{captureStdout:!0,stdoutLines:0},(function(e,r){if(e)return t(e);var n=r.get().split(d),i={};n.forEach((function(t){var e=t.match(f);e&&e[3].split(",").forEach((function(t){t in i||(i[t]={description:e[4],canDemux:!1,canMux:!1}),"D"===e[1]&&(i[t].canDemux=!0),"E"===e[2]&&(i[t].canMux=!0)}))})),t(null,m.formats=i)}))},t._checkCapabilities=function(t){var e=this;o.waterfall([function(t){e.availableFormats(t)},function(t,r){var n;return 1===(n=e._outputs.reduce((function(e,r){var n=r.options.find("-f",1);return n&&(n[0]in t&&t[n[0]].canMux||e.push(n)),e}),[])).length?r(new Error("Output format "+n[0]+" is not available")):n.length>1?r(new Error("Output formats "+n.join(", ")+" are not available")):1===(n=e._inputs.reduce((function(e,r){var n=r.options.find("-f",1);return n&&(n[0]in t&&t[n[0]].canDemux||e.push(n[0])),e}),[])).length?r(new Error("Input format "+n[0]+" is not available")):n.length>1?r(new Error("Input formats "+n.join(", ")+" are not available")):void r()},function(t){e.availableEncoders(t)},function(t,r){var n;return 1===(n=e._outputs.reduce((function(e,r){var n=r.audio.find("-acodec",1);return n&&"copy"!==n[0]&&(n[0]in t&&"audio"===t[n[0]].type||e.push(n[0])),e}),[])).length?r(new Error("Audio codec "+n[0]+" is not available")):n.length>1?r(new Error("Audio codecs "+n.join(", ")+" are not available")):1===(n=e._outputs.reduce((function(e,r){var n=r.video.find("-vcodec",1);return n&&"copy"!==n[0]&&(n[0]in t&&"video"===t[n[0]].type||e.push(n[0])),e}),[])).length?r(new Error("Video codec "+n[0]+" is not available")):n.length>1?r(new Error("Video codecs "+n.join(", ")+" are not available")):void r()}],t)}}},function(t,e,r){"use strict";var n=r(10).spawn;function i(t){return t.match(/^TAG:/)}function o(t){return t.match(/^DISPOSITION:/)}function a(t){var e=t.split(/\r\n|\r|\n/),r={streams:[],format:{},chapters:[]};function n(t){for(var r={},n=e.shift();void 0!==n;){if(n.toLowerCase()=="[/"+t+"]")return r;if(n.match(/^\[/))n=e.shift();else{var i=n.match(/^([^=]+)=(.*)$/);i&&(!i[1].match(/^TAG:/)&&i[2].match(/^[0-9]+(\.[0-9]+)?$/)?r[i[1]]=Number(i[2]):r[i[1]]=i[2]),n=e.shift()}}return r}for(var i=(e=e.filter((function(t){return t.length>0}))).shift();void 0!==i;){if(i.match(/^\[stream/i)){var o=n("stream");r.streams.push(o)}else if(i.match(/^\[chapter/i)){var a=n("chapter");r.chapters.push(a)}else"[format]"===i.toLowerCase()&&(r.format=n("format"));i=e.shift()}return r}t.exports=function(t){t.ffprobe=function(){var t,e=null,r=[],s=arguments[arguments.length-1],u=!1;function c(t,e){u||(u=!0,s(t,e))}switch(arguments.length){case 3:e=arguments[0],r=arguments[1];break;case 2:"number"==typeof arguments[0]?e=arguments[0]:Array.isArray(arguments[0])&&(r=arguments[0])}if(null===e){if(!this._currentInput)return c(new Error("No input specified"));t=this._currentInput}else if(!(t=this._inputs[e]))return c(new Error("Invalid input index"));this._getFfprobePath((function(e,u){if(e)return c(e);if(!u)return c(new Error("Cannot find ffprobe"));var l="",p=!1,f="",d=!1,h=t.isStream?"pipe:0":t.source,m=n(u,["-show_streams","-show_format"].concat(r,h));t.isStream&&(m.stdin.on("error",(function(t){["ECONNRESET","EPIPE"].indexOf(t.code)>=0||c(t)})),m.stdin.on("close",(function(){t.source.pause(),t.source.unpipe(m.stdin)})),t.source.pipe(m.stdin)),m.on("error",s);var g=null;function y(t){if(t&&(g=t),b&&p&&d){if(g)return f&&(g.message+="\n"+f),c(g);var e=a(l);[e.format].concat(e.streams).forEach((function(t){if(t){var e=Object.keys(t).filter(i);e.length&&(t.tags=t.tags||{},e.forEach((function(e){t.tags[e.substr(4)]=t[e],delete t[e]})));var r=Object.keys(t).filter(o);r.length&&(t.disposition=t.disposition||{},r.forEach((function(e){t.disposition[e.substr(12)]=t[e],delete t[e]})))}})),c(null,e)}}var b=!1;m.on("exit",(function(t,e){b=!0,t?y(new Error("ffprobe exited with code "+t)):e?y(new Error("ffprobe was killed with signal "+e)):y()})),m.stdout.on("data",(function(t){l+=t})),m.stdout.on("close",(function(){p=!0,y()})),m.stderr.on("data",(function(t){f+=t})),m.stderr.on("close",(function(){d=!0,y()}))}))}}},function(t,e,r){"use strict";var n=r(3),i=r(2),o=r(4).PassThrough,a=r(11),s=r(1);t.exports=function(t){t.saveToFile=t.save=function(t){return this.output(t).run(),this},t.writeToStream=t.pipe=t.stream=function(t,e){if(t&&!("writable"in t)&&(e=t,t=void 0),!t){if(process.version.match(/v0\.8\./))throw new Error("PassThrough stream is not supported on node v0.8");t=new o}return this.output(t,e).run(),t},t.takeScreenshots=t.thumbnail=t.thumbnails=t.screenshot=t.screenshots=function(t,e){var r,o=this,u=this._currentInput.source;if("number"==typeof(t=t||{count:1})&&(t={count:t}),"folder"in t||(t.folder=e||"."),"timestamps"in t&&(t.timemarks=t.timestamps),!("timemarks"in t)){if(!t.count)throw new Error("Cannot take screenshots: neither a count nor a timemark list are specified");var c=100/(1+t.count);t.timemarks=[];for(var l=0;l<t.count;l++)t.timemarks.push(c*(l+1)+"%")}if("size"in t){var p=t.size.match(/^(\d+)x(\d+)$/),f=t.size.match(/^(\d+)x\?$/),d=t.size.match(/^\?x(\d+)$/),h=t.size.match(/^(\d+)%$/);if(!(p||f||d||h))throw new Error("Invalid size parameter: "+t.size)}function m(t){r?t(null,r):o.ffprobe((function(e,n){r=n,t(e,n)}))}return a.waterfall([function(e){if(t.timemarks.some((function(t){return(""+t).match(/^[\d.]+%$/)}))){if("string"!=typeof u)return e(new Error("Cannot compute screenshot timemarks with an input stream, please specify fixed timemarks"));m((function(r,n){if(r)e(r);else{var i=n.streams.reduce((function(t,e){return"video"===e.codec_type&&e.width*e.height>t.width*t.height?e:t}),{width:0,height:0});if(0===i.width)return e(new Error("No video stream in input, cannot take screenshots"));var o=Number(i.duration);if(isNaN(o)&&(o=Number(n.format.duration)),isNaN(o))return e(new Error("Could not get input duration, please specify fixed timemarks"));t.timemarks=t.timemarks.map((function(t){return(""+t).match(/^([\d.]+)%$/)?o*parseFloat(t)/100:t})),e()}}))}else e()},function(e){t.timemarks=t.timemarks.map((function(t){return s.timemarkToSeconds(t)})).sort((function(t,e){return t-e})),e()},function(e){var r=t.filename||"tn.png";if(-1===r.indexOf(".")&&(r+=".png"),t.timemarks.length>1&&!r.match(/%(s|0*i)/)){var n=i.extname(r);r=i.join(i.dirname(r),i.basename(r,n)+"_%i"+n)}e(null,r)},function(t,e){if(t.match(/%[bf]/)){if("string"!=typeof u)return e(new Error("Cannot replace %f or %b when using an input stream"));t=t.replace(/%f/g,i.basename(u)).replace(/%b/g,i.basename(u,i.extname(u)))}e(null,t)},function(t,e){if(t.match(/%[whr]/)){if(p)return e(null,t,p[1],p[2]);m((function(r,n){if(r)return e(new Error("Could not determine video resolution to replace %w, %h or %r"));var i=n.streams.reduce((function(t,e){return"video"===e.codec_type&&e.width*e.height>t.width*t.height?e:t}),{width:0,height:0});if(0===i.width)return e(new Error("No video stream in input, cannot replace %w, %h or %r"));var o=i.width,a=i.height;f?(a=a*Number(f[1])/o,o=Number(f[1])):d?(o=o*Number(d[1])/a,a=Number(d[1])):h&&(o=o*Number(h[1])/100,a=a*Number(h[1])/100),e(null,t,2*Math.round(o/2),2*Math.round(a/2))}))}else e(null,t,-1,-1)},function(t,e,r,n){n(null,t=t.replace(/%r/g,"%wx%h").replace(/%w/g,e).replace(/%h/g,r))},function(e,r){var n=t.timemarks.map((function(t,r){return e.replace(/%s/g,s.timemarkToSeconds(t)).replace(/%(0*)i/g,(function(t,e){var n=""+(r+1);return e.substr(0,Math.max(0,e.length+1-n.length))+n}))}));o.emit("filenames",n),r(null,n)},function(e,r){n.exists(t.folder,(function(i){i?r(null,e):n.mkdir(t.folder,(function(t){t?r(t):r(null,e)}))}))}],(function(e,r){if(e)return o.emit("error",e);var n,a=t.timemarks.length,s=[n={filter:"split",options:a,outputs:[]}];if("size"in t){o.size(t.size);var u=o._currentOutput.sizeFilters.get().map((function(t,e){return e>0&&(t.inputs="size"+(e-1)),t.outputs="size"+e,t}));n.inputs="size"+(u.length-1),s=u.concat(s),o._currentOutput.sizeFilters.clear()}for(var c=0,l=0;l<a;l++){var p="screen"+l;n.outputs.push(p),0===l&&(c=t.timemarks[l],o.seekInput(c)),o.output(i.join(t.folder,r[l])).frames(1).map(p),l>0&&o.seek(t.timemarks[l]-c)}o.complexFilter(s),o.run()})),this},t.mergeToFile=t.concatenate=t.concat=function(t,e){var r=this._inputs.filter((function(t){return!t.isStream}))[0],n=this;return this.ffprobe(this._inputs.indexOf(r),(function(r,i){if(r)return n.emit("error",r);var o=i.streams.some((function(t){return"audio"===t.codec_type})),a=i.streams.some((function(t){return"video"===t.codec_type}));n.output(t,e).complexFilter({filter:"concat",options:{n:n._inputs.length,v:a?1:0,a:o?1:0}}).run()})),this}}}]);